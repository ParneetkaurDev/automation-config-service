meta:
  domain: 'ONDC:RETINVL'
  version: 1.2.5
  flowId: ORDER_FLOW_BASELINE
transaction_data:
  transaction_id: 3d642d45-ec0a-4555-a115-da3a2145b66d
  latest_timestamp: '1970-01-01T00:00:00.000Z'
  bap_id: bap.example.com
  bap_uri: 'https://bap.example.com'
  bpp_id: bpp.example.com
  bpp_uri: 'https://bpp.example.com'
steps:
  - api: init
    action_id: init_1
    owner: BAP
    responseFor: null
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBjb25zdCBwYXlsb2FkID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkZWZhdWx0UGF5bG9hZCkpOwoKICBjb25zdCBpbnB1dHMgPSBzZXNzaW9uRGF0YS51c2VyX2lucHV0cyB8fCB7fTsKICBjb25zb2xlLmxvZygiaW5wdXRzIiwgSlNPTi5zdHJpbmdpZnkoaW5wdXRzKSk7CiAgcGF5bG9hZC5jb250ZXh0LmNpdHkgPSBpbnB1dHMuY2l0eV9jb2RlIHx8ICJzdGQ6MDExIjsKICAvLyBwYXlsb2FkLmNvbnRleHQudGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpOwogIC8vIHBheWxvYWQuY29udGV4dC50dGwgPSAiUFQxSCI7CgogIHBheWxvYWQubWVzc2FnZS5vcmRlci50eXBlID0gaW5wdXRzLm9yZGVyX3R5cGU7CgogIGlmIChpbnB1dHMucHJvdmlkZXJfbG9jYXRpb24gJiYgQXJyYXkuaXNBcnJheShpbnB1dHMucHJvdmlkZXJfbG9jYXRpb24pKSB7CiAgICBwYXlsb2FkLm1lc3NhZ2Uub3JkZXIucHJvdmlkZXIubG9jYXRpb25zID0KICAgICAgaW5wdXRzLnByb3ZpZGVyX2xvY2F0aW9uLm1hcCgobG9jYXRpb24pID0+IHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgaWQ6IGxvY2F0aW9uLAogICAgICAgIH07CiAgICAgIH0pOwogIH0gZWxzZSBpZiAoCiAgICBpbnB1dHMucHJvdmlkZXJfbG9jYXRpb24gJiYKICAgIHR5cGVvZiBpbnB1dHMucHJvdmlkZXJfbG9jYXRpb24gPT09ICJzdHJpbmciCiAgKSB7CiAgICBwYXlsb2FkLm1lc3NhZ2Uub3JkZXIucHJvdmlkZXIubG9jYXRpb25zID0gWwogICAgICB7CiAgICAgICAgaWQ6IGlucHV0cy5wcm92aWRlcl9sb2NhdGlvbiwKICAgICAgfSwKICAgIF07CiAgfQoKICBwYXlsb2FkLm1lc3NhZ2Uub3JkZXIuaXRlbXMgPSAoaW5wdXRzLml0ZW1zIHx8IFtdKS5tYXAoKGl0ZW0pID0+ICh7CiAgICBpZDogaXRlbS5pdGVtSWQsCiAgICBkZXNjcmlwdG9yOiB7CiAgICAgIGNvZGU6ICIzOkdUSU4jIgogICAgfSwKICAgIHF1YW50aXR5OiB7CiAgICAgIGNvdW50OiBOdW1iZXIoaXRlbS5xdWFudGl0eSkKICAgIH0sCiAgICAuLi4oaXRlbS5lc3RpbWF0ZWRfcHJpY2UgJiYgewogICAgICBwcmljZTogewogICAgICAgIGVzdGltYXRlZF92YWx1ZTogU3RyaW5nKGl0ZW0uZXN0aW1hdGVkX3ByaWNlKQogICAgICB9CiAgICB9KQogIH0pKTsKCiAgcGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50cyA9IFsKICAgIHsKICAgICAgaWQ6ICJGMSIsCiAgICAgIHR5cGU6ICJEZWxpdmVyeSIsCiAgICAgIGVuZDogewogICAgICAgIGxvY2F0aW9uOiB7CiAgICAgICAgICBncHM6IGlucHV0cy5sb2NhdGlvbl9ncHMsCiAgICAgICAgICBhZGRyZXNzOiB7CiAgICAgICAgICAgIGFyZWFfY29kZTogaW5wdXRzLmxvY2F0aW9uX3Bpbl9jb2RlCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgXTsKCiAgcmV0dXJuIHBheWxvYWQ7Cn0=
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'ONDC:RETINVL'
          action: init
          core_version: 1.2.5
          bap_id: bnp.com
          bap_uri: 'https://bnp.com/ondc'
          bpp_id: snp.com
          bpp_uri: 'https://snp.com/ondc'
          transaction_id: T2
          message_id: M3
          city: 'std:080'
          country: IND
          timestamp: '2025-01-08T09:00:00.000Z'
          ttl: PT1H
        message:
          order:
            type: ILBN
            provider:
              id: P1
              locations:
                - id: L1
            items:
              - id: I1
                descriptor:
                  code: '3:GTIN#'
                quantity:
                  count: 1
                price:
                  estimated_value: '67999'
            fulfillments:
              - type: Delivery
                end:
                  location:
                    gps: '12.4535,77.9283'
                    address:
                      area_code: '560037'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        city_code: $.context.city
        provider: $.message.order.provider
        selected_fulfillments: $.message.order.fulfillments
        selected_items: $.message.order.items
      inputs:
        id: retinvl_init
        jsonSchema:
          $schema: 'http://json-schema.org/draft-07/schema#'
          type: object
          properties:
            order_type:
              type: string
              enum:
                - ILBN
                - ILFP
                - ILBP
              default: ILBN
            city_code:
              type: string
              default: 'std:080'
            provider:
              type: string
              default: P1
            provider_location:
              type: string
              default: L1
            location_gps:
              type: string
              default: '19.129076,72.825803'
            location_pin_code:
              type: string
              default: '400053'
            items:
              type: array
              default: []
              items:
                type: object
                properties:
                  itemId:
                    type: string
                    default: I1
                  quantity:
                    type: number
                    default: 1
                  location:
                    type: string
                    default: L1
                  estimated_price:
                    type: string
                    pattern: '^(\d+\.\d{1,2}|\d+)$'
                    default: ''
                  gtin_code:
                    type: string
                    pattern: '^[0-9A-Za-z:#+-]{3,50}$'
                    default: '3:GTIN#'
                required:
                  - itemId
                  - quantity
                  - estimated_price
                additionalProperties: true
                default: {}
          required:
            - order_type
            - provider
            - provider_location
            - location_gps
            - location_pin_code
            - items
          additionalProperties: true
          default: {}
  - api: on_init
    action_id: on_init_1
    owner: BPP
    responseFor: init_1
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnByb3ZpZGVyID0gc2Vzc2lvbkRhdGEucHJvdmlkZXJbMF07CiAgZGVmYXVsdFBheWxvYWQuY29udGV4dC5jaXR5ID0gc2Vzc2lvbkRhdGEuY2l0eV9jb2RlWzBdOwogIGNvbnN0IHNlbGVjdGVkSXRlbXNPYmogPSBzZXNzaW9uRGF0YS5zZWxlY3RlZF9pdGVtc1swXTsKCiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5pdGVtcyA9IHNlbGVjdGVkSXRlbXNPYmoKICAgIC5maWx0ZXIoQm9vbGVhbikKICAgIC5tYXAoKGl0ZW0pID0+ICh7CiAgICAgIGlkOiBpdGVtLmlkLAogICAgICBmdWxmaWxsbWVudF9pZDogaXRlbS5mdWxmaWxsbWVudF9pZCB8fCAiRjEiLAogICAgICAuLi4oaXRlbS5kZXNjcmlwdG9yICYmIHsKICAgICAgICBkZXNjcmlwdG9yOiBpdGVtLmRlc2NyaXB0b3IKICAgICAgfSksCiAgICAgIHF1YW50aXR5OiB7CiAgICAgIGNvdW50OiAoaXRlbS5xdWFudGl0eSkKICAgIH0KICAgIH0pKTsKCiAgY29uc3QgcXVvdGUgPSBjcmVhdGVRdW90ZSgKICAgIHNlbGVjdGVkSXRlbXNPYmoubWFwKChpdGVtKSA9PiB7CiAgICAgIHJldHVybiB7CiAgICAgICAgaWQ6IGl0ZW0uaWQsCiAgICAgICAgY291bnQ6IGl0ZW0ucXVhbnRpdHkuY291bnQsCiAgICAgICAgZnVsZmlsbG1lbnRfaWQ6ICJGMSIsCiAgICAgIH07CiAgICB9KSwKICAgIHNlc3Npb25EYXRhLAogICAgZGVmYXVsdFBheWxvYWQsCiAgICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLmZ1bGZpbGxtZW50cwogICk7CiAgZGVmYXVsdFBheWxvYWQubWVzc2FnZS5vcmRlci5xdW90ZSA9IHF1b3RlOwogIGNvbnN0IHRvdGFsQW1vdW50ID0KICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2Uub3JkZXIucXVvdGU/LnByaWNlPy52YWx1ZSB8fCAiMTAwMDAuMDAiOwoKICBkZWZhdWx0UGF5bG9hZC5tZXNzYWdlLm9yZGVyLnBheW1lbnRzID0gZ2VuZXJhdGVJbml0UGF5bWVudHMoCiAgICB0b3RhbEFtb3VudCwKICAgIHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzCiAgKTsKICBjb25zb2xlLmxvZygiZGVmYXVsdFBheWxvYWQiLCBKU09OLnN0cmluZ2lmeShkZWZhdWx0UGF5bG9hZCkpOwogIHJldHVybiBkZWZhdWx0UGF5bG9hZDsKfQ==
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'ONDC:RETINVL'
          action: on_init
          core_version: 1.2.5
          bap_id: bnp.com
          bap_uri: 'https://bnp.com/ondc'
          bpp_id: snp.com
          bpp_uri: 'https://snp.com/ondc'
          transaction_id: T2
          message_id: M3
          city: 'std:080'
          country: IND
          timestamp: '2025-01-08T09:00:30.000Z'
        message:
          order:
            type: ILBN
            provider:
              id: P1
              locations:
                - id: L1
            items:
              - id: I1
                descriptor:
                  code: '3:GTIN#'
                quantity:
                  count: 1
            fulfillments:
              - id: F1
                type: Delivery
                tracking: false
                end:
                  location:
                    gps: '12.4535,77.9283'
                    address:
                      area_code: '560037'
              - id: F2
                type: Self-Pickup
            quote:
              price:
                currency: INR
                value: '68108.00'
              breakup:
                - '@ondc/org/item_id': I1
                  '@ondc/org/item_quantity':
                    count: 1
                  title: Apple iPhone 14
                  '@ondc/org/title_type': item
                  price:
                    currency: INR
                    value: '67999.00'
                  item:
                    price:
                      currency: INR
                      value: '67999.00'
                - '@ondc/org/item_id': I1
                  title: Tax
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '0.00'
                - '@ondc/org/item_id': F1
                  title: Delivery charges
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: '50.00'
                - '@ondc/org/item_id': F1
                  title: Tax
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '9.00'
                  item:
                    tags:
                      - code: quote
                        list:
                          - code: type
                            value: fulfillment
                - '@ondc/org/item_id': F1
                  title: Packing charges
                  '@ondc/org/title_type': packing
                  price:
                    currency: INR
                    value: '25.00'
                - '@ondc/org/item_id': F2
                  title: Delivery charges
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: 00.00
                - '@ondc/org/item_id': F2
                  title: Packing charges
                  '@ondc/org/title_type': packing
                  price:
                    currency: INR
                    value: '25.00'
                - '@ondc/org/item_id': I1
                  title: Discount
                  '@ondc/org/title_type': discount
                  price:
                    currency: INR
                    value: '-10.00'
                - '@ondc/org/item_id': F1
                  title: Convenience Fee
                  '@ondc/org/title_type': misc
                  price:
                    currency: INR
                    value: '10.00'
              ttl: P1D
            payments:
              - id: '1'
                type: ON-ORDER
                status: NOT-PAID
                collected_by: BAP
              - id: '3'
                type: PART-PAYMENT
                tags:
                  - descriptor:
                      code: LINKED-PAYMENTS
                    list:
                      - descriptor:
                          code: pymnt-part-1
                        value: '1'
                      - descriptor:
                          code: pymnt-part-2
                        value: '2'
              - id: pymnt-part-1
                type: ON-ORDER
                status: NOT-PAID
                collected_by: BAP
                tags:
                  - descriptor:
                      code: ADV-DEPOSIT
                params:
                  amount: '2000.00'
                  currency: INR
              - id: pymnt-part-2
                type: ON-FULFILLMENT
                status: NOT-PAID
                collected_by: BPP
                tags:
                  - descriptor:
                      code: FINAL-PAYMENT
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        city_code: $.context.city
        on_init_fulfillments: $.message.order.fulfillments
        provider: $.message.order.provider
        order_type: $.message.order.type
        on_init_payments: $.message.order.payments
        on_init_quote: $.message.order.quote
      inputs:
        id: ExampleInputId
        jsonSchema:
          type: object
          properties:
            want_part_payment:
              type: boolean
              default: true
            advance_amount:
              type: string
              pattern: '^(\d+\.\d{1,2}|\d+)$'
          required:
            - want_part_payment
            - advance_amount
  - api: confirm
    action_id: confirm_1
    owner: BAP
    responseFor: null
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBjb25zdCBwYXlsb2FkID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkZWZhdWx0UGF5bG9hZCkpOwogIHBheWxvYWQuY29udGV4dC5jaXR5ID0gc2Vzc2lvbkRhdGEuY2l0eV9jb2RlWzBdCgogIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTsKICBwYXlsb2FkLmNvbnRleHQudGltZXN0YW1wID0gdGltZXN0YW1wOwoKICBjb25zdCBpbnB1dHMgPSBzZXNzaW9uRGF0YS51c2VyX2lucHV0cyB8fCB7fTsKCiAgY29uc3Qgb3JkZXIgPSBwYXlsb2FkLm1lc3NhZ2Uub3JkZXI7CgogIG9yZGVyLmlkID0gdXVpZHY0KCk7CiAgb3JkZXIuc3RhdGUgPSAiQ3JlYXRlZCI7CiAgb3JkZXIudHlwZSA9IHNlc3Npb25EYXRhLm9yZGVyX3R5cGVbMF07CiAgb3JkZXIuY3JlYXRlZF9hdCA9IHRpbWVzdGFtcDsKICBvcmRlci51cGRhdGVkX2F0ID0gdGltZXN0YW1wOwoKICBpZiAoc2Vzc2lvbkRhdGEucHJvdmlkZXIubGVuZ3RoID4gMCkgewogICAgcGF5bG9hZC5tZXNzYWdlLm9yZGVyLnByb3ZpZGVyID0gc2Vzc2lvbkRhdGEucHJvdmlkZXJbMF0KICB9CgoKICBjb25zdCBzZWxlY3RlZEl0ZW1zID0gc2Vzc2lvbkRhdGEuc2VsZWN0ZWRfaXRlbXM/LlswXSB8fCBbXTsKCiAgb3JkZXIuYmlsbGluZyA9IHsKICAgIG5hbWU6IGlucHV0cy5iaWxsaW5nX25hbWUgfHwgIk9OREMgYnV5ZXIiLAogICAgYWRkcmVzczogewogICAgICBuYW1lOiBpbnB1dHMuYWRkcmVzc19uYW1lIHx8ICJNeSBBZGRyZXNzIiwKICAgICAgYnVpbGRpbmc6IGlucHV0cy5hZGRyZXNzX2J1aWxkaW5nIHx8ICJCdWlsZGluZyIsCiAgICAgIGxvY2FsaXR5OiBpbnB1dHMuYWRkcmVzc19sb2NhbGl0eSB8fCAiTG9jYWxpdHkiLAogICAgICBjaXR5OiBpbnB1dHMuY2l0eV9uYW1lIHx8ICJCZW5nYWx1cnUiLAogICAgICBzdGF0ZTogaW5wdXRzLnN0YXRlX25hbWUgfHwgIkthcm5hdGFrYSIsCiAgICAgIGNvdW50cnk6ICJJTkQiLAogICAgICBhcmVhX2NvZGU6IGlucHV0cy5sb2NhdGlvbl9waW5fY29kZSB8fCAiNTYwMDAyIgogICAgfSwKICAgIHBob25lOiBpbnB1dHMucGhvbmUgfHwgIjk5OTk5OTk5OTkiLAogICAgZW1haWw6IGlucHV0cy5lbWFpbCB8fCAiYnV5ZXJAdGVzdC5jb20iLAogICAgY3JlYXRlZF9hdDogdGltZXN0YW1wLAogICAgdXBkYXRlZF9hdDogdGltZXN0YW1wCiAgfTsKCiAgY29uc3QgZnVsZmlsbG1lbnRUeXBlID0gaW5wdXRzLmZ1bGZpbGxtZW50X3R5cGUgfHwgIkRlbGl2ZXJ5IjsKICBjb25zdCBmdWxmaWxsbWVudElkID0KICAgIGZ1bGZpbGxtZW50VHlwZSA9PT0gIlNlbGYtUGlja3VwIiA/ICJGMiIgOiAiRjEiOwogIG9yZGVyLml0ZW1zID0gc2VsZWN0ZWRJdGVtcy5tYXAoKGl0ZW0pID0+ICh7CiAgICBpZDogaXRlbS5pZCwKICAgIGZ1bGZpbGxtZW50X2lkOiBmdWxmaWxsbWVudElkIHx8ICJGMSIsCiAgICBxdWFudGl0eTogewogICAgICBjb3VudDogTnVtYmVyKGl0ZW0ucXVhbnRpdHk/LmNvdW50IHx8IGl0ZW0uY291bnQgfHwgMSkKICAgIH0KICB9KSk7CiAgY29uc3QgZnVsZmlsbG1lbnRCYXNlID0gewogICAgaWQ6IGZ1bGZpbGxtZW50SWQsCiAgICB0eXBlOiBmdWxmaWxsbWVudFR5cGUsCiAgICB0cmFja2luZzogZmFsc2UKICB9OwoKICBpZiAoZnVsZmlsbG1lbnRUeXBlID09PSAiRGVsaXZlcnkiKSB7CiAgICBmdWxmaWxsbWVudEJhc2UuZW5kID0gewogICAgICBwZXJzb246IHsKICAgICAgICBuYW1lOiBpbnB1dHMuY3VzdG9tZXJfbmFtZSB8fCAiQ3VzdG9tZXIiCiAgICAgIH0sCiAgICAgIGNvbnRhY3Q6IHsKICAgICAgICBwaG9uZTogaW5wdXRzLnBob25lIHx8ICI5OTk5OTk5OTk5IiwKICAgICAgICBlbWFpbDogaW5wdXRzLmVtYWlsIHx8ICJidXllckB0ZXN0LmNvbSIKICAgICAgfSwKICAgICAgbG9jYXRpb246IHsKICAgICAgICBncHM6IGlucHV0cy5sb2NhdGlvbl9ncHMgfHwgIjEyLjQ1MzUsNzcuOTI4MyIsCiAgICAgICAgYWRkcmVzczogewogICAgICAgICAgbmFtZTogaW5wdXRzLmFkZHJlc3NfbmFtZSB8fCAiTXkgQWRkcmVzcyIsCiAgICAgICAgICBidWlsZGluZzogaW5wdXRzLmFkZHJlc3NfYnVpbGRpbmcgfHwgIkJ1aWxkaW5nIiwKICAgICAgICAgIGxvY2FsaXR5OiBpbnB1dHMuYWRkcmVzc19sb2NhbGl0eSB8fCAiTG9jYWxpdHkiLAogICAgICAgICAgY2l0eTogaW5wdXRzLmNpdHlfbmFtZSB8fCAiQmVuZ2FsdXJ1IiwKICAgICAgICAgIHN0YXRlOiBpbnB1dHMuc3RhdGVfbmFtZSB8fCAiS2FybmF0YWthIiwKICAgICAgICAgIGNvdW50cnk6ICJJTkQiLAogICAgICAgICAgYXJlYV9jb2RlOiBpbnB1dHMubG9jYXRpb25fcGluX2NvZGUgfHwgIjU2MDAzNyIKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgfQoKICBpZiAoZnVsZmlsbG1lbnRUeXBlID09PSAiU2VsZi1QaWNrdXAiKSB7CiAgICBmdWxmaWxsbWVudEJhc2UuZW5kID0gewogICAgICBwZXJzb246IHsKICAgICAgICBuYW1lOiBpbnB1dHMuY3VzdG9tZXJfbmFtZSB8fCAiQ3VzdG9tZXIiCiAgICAgIH0sCiAgICAgIGNvbnRhY3Q6IHsKICAgICAgICBwaG9uZTogaW5wdXRzLnBob25lIHx8ICI5OTk5OTk5OTk5IiwKICAgICAgICBlbWFpbDogaW5wdXRzLmVtYWlsIHx8ICJidXllckB0ZXN0LmNvbSIKICAgICAgfSwKICAgICAgbG9jYXRpb246IHsKICAgICAgICBncHM6IGlucHV0cy5sb2NhdGlvbl9ncHMgfHwgIjEyLjQ1MzUsNzcuOTI4MyIsCiAgICAgICAgYWRkcmVzczogewogICAgICAgICAgbmFtZTogaW5wdXRzLmFkZHJlc3NfbmFtZSB8fCAiUGlja3VwIExvY2F0aW9uIiwKICAgICAgICAgIGJ1aWxkaW5nOiBpbnB1dHMuYWRkcmVzc19idWlsZGluZyB8fCAiQnVpbGRpbmciLAogICAgICAgICAgbG9jYWxpdHk6IGlucHV0cy5hZGRyZXNzX2xvY2FsaXR5IHx8ICJMb2NhbGl0eSIsCiAgICAgICAgICBjaXR5OiBpbnB1dHMuY2l0eV9uYW1lIHx8ICJCZW5nYWx1cnUiLAogICAgICAgICAgc3RhdGU6IGlucHV0cy5zdGF0ZV9uYW1lIHx8ICJLYXJuYXRha2EiLAogICAgICAgICAgY291bnRyeTogIklORCIsCiAgICAgICAgICBhcmVhX2NvZGU6IGlucHV0cy5sb2NhdGlvbl9waW5fY29kZSB8fCAiNTYwMDM3IgogICAgICAgIH0KICAgICAgfQogICAgfTsKICB9CgogIG9yZGVyLmZ1bGZpbGxtZW50cyA9IFtmdWxmaWxsbWVudEJhc2VdOwogIGlmIChzZXNzaW9uRGF0YT8ub25faW5pdF9wYXltZW50cy5sZW5ndGggPiAxKSB7CiAgICBjb25zdCBpbml0UGF5bWVudHMgPQogICAgICBzZXNzaW9uRGF0YS5vbl9pbml0X3BheW1lbnRzWzBdIHx8IFtdOwoKICAgIHBheWxvYWQubWVzc2FnZS5vcmRlci5wYXltZW50cyA9CiAgICAgIG5vcm1hbGl6ZVBheW1lbnRzKGluaXRQYXltZW50cyxwYXlsb2FkLmNvbnRleHQuYWN0aW9uKTsKICB9CgogIHJldHVybiBwYXlsb2FkOwp9
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'ONDC:RETINVL'
          action: confirm
          core_version: 1.2.5
          bap_id: bnp.com
          bap_uri: 'https://bnp.com/ondc'
          bpp_id: snp.com
          bpp_uri: 'https://snp.com/ondc'
          transaction_id: T2
          message_id: M4
          city: 'std:080'
          country: IND
          timestamp: '2025-01-08T09:30:00.000Z'
          ttl: PT30S
        message:
          order:
            type: ILBN
            id: O1
            state: Created
            provider:
              id: P1
              locations:
                - id: L1
            items:
              - id: I1
                fulfillment_id: F2
                quantity:
                  count: 1
            billing:
              name: ONDC buyer
              address:
                name: 'my house or door or floor #'
                building: 'my building name or house #'
                locality: my street name
                city: Bengaluru
                state: Karnataka
                country: IND
                area_code: '560037'
              phone: '9886098860'
              email: nobody@nomail.com
              created_at: '2025-01-08T09:00:00.000Z'
              updated_at: '2025-01-08T09:00:00.000Z'
            fulfillments:
              - id: F2
                type: Self-Pickup
                tracking: false
                end:
                  person:
                    name: name_of_person
                  contact:
                    email: nobody@nomail.com
                    phone: '9886098860'
                  location:
                    gps: '12.4535,77.9283'
                    address:
                      name: 'my house or door or floor #'
                      building: 'my building name or house #'
                      locality: my street name
                      city: Bengaluru
                      state: Karnataka
                      country: IND
                      area_code: '560037'
            payments:
              - id: '3'
                type: PART-PAYMENT
                tags:
                  - descriptor:
                      code: LINKED-PAYMENTS
                    list:
                      - descriptor:
                          code: pymnt-part-1
                        value: '1'
                      - descriptor:
                          code: pymnt-part-2
                        value: '2'
              - id: pymnt-part-1
                type: ON-ORDER
                status: PAID
                collected_by: BAP
                tags:
                  - descriptor:
                      code: ADV-DEPOSIT
                params:
                  amount: '2000.00'
                  currency: INR
                  transaction_id: payment-utr-1234
              - id: pymnt-part-2
                type: ON-FULFILLMENT
                status: NOT-PAID
                collected_by: BPP
                tags:
                  - descriptor:
                      code: FINAL-PAYMENT
            tags:
              - code: bap_terms
                list:
                  - code: static_terms
                    value: >-
                      https://github.com/ONDC-Official/NP-Static-Terms/buyerNP_BNP/1.0/tc.pdf
                  - code: tax_number
                    value: gst_number_of_buyerNP
            created_at: '2025-01-08T09:30:00.000Z'
            updated_at: '2025-01-08T09:30:00.000Z'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        city_code: $.context.city
        order_id: $.message.order.id
        provider: $.message.order.provider
        items: $.message.order.items
        billing: $.message.order.billing
        confirm_fulfillments: $.message.order.fulfillments
        confirm_order: $.message.order
      inputs:
        id: ExampleInputId
        jsonSchema:
          type: object
          properties:
            fulfillment_type:
              type: string
              enum:
                - Delivery
                - Self-Pickup
              default: Delivery
            billing_name:
              type: string
              default: ONDC buyer
            phone:
              type: string
              pattern: '^[0-9]{10}$'
              default: '9886098860'
            email:
              type: string
              format: email
              default: buyer@test.com
            location_gps:
              type: string
              pattern: '^[-+]?([1-8]?\d|90)\.\d+,\s*[-+]?(180|1[0-7]\d|[1-9]?\d)\.\d+$'
              default: '12.4535,77.9283'
            location_pin_code:
              type: string
              pattern: '^[0-9]{6}$'
              default: '560002'
            address_name:
              type: string
              default: My Address
            address_building:
              type: string
              default: My Building
            address_locality:
              type: string
              default: My Street
            city_name:
              type: string
              default: Bengaluru
            state_name:
              type: string
              default: Karnataka
          required:
            - fulfillment_type
  - api: on_confirm
    action_id: on_confirm_1
    owner: BPP
    responseFor: confirm_1
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBjb25zdCBwYXlsb2FkID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkZWZhdWx0UGF5bG9hZCkpOwogIHBheWxvYWQuY29udGV4dC5jaXR5ID0gc2Vzc2lvbkRhdGEuY2l0eV9jb2RlWzBdOwoKICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7CiAgcGF5bG9hZC5jb250ZXh0LnRpbWVzdGFtcCA9IHRpbWVzdGFtcDsKCiAgY29uc3QgY29uZmlybU9yZGVyID0KICAgIHNlc3Npb25EYXRhLmNvbmZpcm1fb3JkZXJbMF0KCiAgaWYgKCFjb25maXJtT3JkZXIpIHsKICAgIHRocm93IG5ldyBFcnJvcigiQ29uZmlybSBwYXlsb2FkIG5vdCBmb3VuZCBpbiBzZXNzaW9uRGF0YSIpOwogIH0KCiAgY29uc29sZS5sb2coImNvbmZpcm1PcmRlciIsIEpTT04uc3RyaW5naWZ5KGNvbmZpcm1PcmRlcikpCgogIGNvbnN0IG9yZGVyID0gcGF5bG9hZC5tZXNzYWdlLm9yZGVyOwogIGNvbnNvbGUubG9nKCJkZWZhdXQgcGF5bG9hZCIsIEpTT04uc3RyaW5naWZ5KG9yZGVyKSkKICBvcmRlci5pZCA9IGNvbmZpcm1PcmRlci5pZDsKICBvcmRlci50eXBlID0gY29uZmlybU9yZGVyLnR5cGU7CiAgb3JkZXIuc3RhdGUgPSAiQWNjZXB0ZWQiOwogIG9yZGVyLmNyZWF0ZWRfYXQgPSBjb25maXJtT3JkZXIuY3JlYXRlZF9hdDsKICBvcmRlci51cGRhdGVkX2F0ID0gdGltZXN0YW1wOwoKICBvcmRlci5wcm92aWRlciA9IGNvbmZpcm1PcmRlci5wcm92aWRlcjsKICBvcmRlci5pdGVtcyA9IGNvbmZpcm1PcmRlci5pdGVtczsKICBvcmRlci5iaWxsaW5nID0gY29uZmlybU9yZGVyLmJpbGxpbmc7CiAgb3JkZXIucGF5bWVudHMgPSBjb25maXJtT3JkZXIucGF5bWVudHM7CiAgb3JkZXIudGFncyA9IGNvbmZpcm1PcmRlci50YWdzOwogIGNvbmZpcm1PcmRlci5xdW90ZSA9IHNlc3Npb25EYXRhLm9uX2luaXRfcXVvdGVbMF0KCiAgY29uc3QgY29uZmlybUZ1bGZpbGxtZW50ID0gY29uZmlybU9yZGVyLmZ1bGZpbGxtZW50c1swXTsKICBvcmRlci5mdWxmaWxsbWVudHMgPSBbCiAgICBidWlsZE9uQ29uZmlybUZ1bGZpbGxtZW50KGNvbmZpcm1PcmRlciwgY29uZmlybUZ1bGZpbGxtZW50KQogIF07CiAgLy8gY29uc29sZS5sb2coImNvbmZyaW0gZnVsZmlsbG1lbnQiLCBKU09OLnN0cmluZ2lmeShjb25maXJtRnVsZmlsbG1lbnQpKTsKICBjb25zdCBmdWxmaWxsbWVudFR5cGUgPSBjb25maXJtRnVsZmlsbG1lbnQudHlwZTsKCiAgLy8gY29uc3QgZnVsZmlsbG1lbnQgPSB7CiAgLy8gICBpZDogY29uZmlybUZ1bGZpbGxtZW50LmlkLAogIC8vICAgdHlwZTogZnVsZmlsbG1lbnRUeXBlLAogIC8vICAgIkBvbmRjL29yZy9UQVQiOiBmdWxmaWxsbWVudFR5cGUgPT09ICJTZWxmLVBpY2t1cCIgPyAiUFQySCIgOiAiUFQ0SCIsCiAgLy8gICBzdGF0ZTogewogIC8vICAgICBkZXNjcmlwdG9yOiB7IGNvZGU6ICJQZW5kaW5nIiB9CiAgLy8gICB9LAogIC8vICAgZW5kOiBjb25maXJtRnVsZmlsbG1lbnQuZW5kCiAgLy8gfTsKCiAgLy8gZnVsZmlsbG1lbnQuc3RhcnQgPSB7CiAgLy8gICBsb2NhdGlvbjogewogIC8vICAgICBpZDogY29uZmlybU9yZGVyLnByb3ZpZGVyLmxvY2F0aW9uc1swXS5pZCwKICAvLyAgICAgZGVzY3JpcHRvcjogewogIC8vICAgICAgIG5hbWU6ICJBQkMgU3RvcmUiCiAgLy8gICAgIH0sCiAgLy8gICAgIGdwczogIjEyLjk1NjMsNzcuNjM2OCIsCiAgLy8gICAgIGFkZHJlc3M6IHsKICAvLyAgICAgICBsb2NhbGl0eTogIkpheWFuYWdhciIsCiAgLy8gICAgICAgY2l0eTogIkJlbmdhbHVydSIsCiAgLy8gICAgICAgYXJlYV9jb2RlOiAiNTYwMDc2IiwKICAvLyAgICAgICBzdGF0ZTogIktBIgogIC8vICAgICB9CiAgLy8gICB9LAogIC8vICAgY29udGFjdDogewogIC8vICAgICBwaG9uZTogIjk4ODYwOTg4NjAiLAogIC8vICAgICBlbWFpbDogIm5vYm9keUBub21haWwuY29tIgogIC8vICAgfQogIC8vIH07CgogIC8vIG9yZGVyLmZ1bGZpbGxtZW50cyA9IFtmdWxmaWxsbWVudF07CgoKICBvcmRlci5xdW90ZSA9IGFkanVzdFF1b3RlRm9yRnVsZmlsbG1lbnQoCiAgICBjb25maXJtT3JkZXIucXVvdGUsCiAgICBmdWxmaWxsbWVudFR5cGUsCiAgICBjb25maXJtRnVsZmlsbG1lbnQuaWQKICApOwogIGlmIChjb25maXJtT3JkZXIucGF5bWVudHMubGVuZ3RoID4gMSkgewogICAgY29uc29sZS5sb2coImludGhpcyBibG9jayIsIEpTT04uc3RyaW5naWZ5KGNvbmZpcm1PcmRlci5wYXltZW50cykpCgogICAgcGF5bG9hZC5tZXNzYWdlLm9yZGVyLnBheW1lbnRzID0KICAgICAgbm9ybWFsaXplUGF5bWVudHMoY29uZmlybU9yZGVyLCBwYXlsb2FkLmNvbnRleHQuYWN0aW9uKTsKICB9CgogIHJldHVybiBwYXlsb2FkOwp9
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'ONDC:RETINVL'
          action: on_confirm
          core_version: 1.2.5
          bap_id: bnp.com
          bap_uri: 'https://bnp.com/ondc'
          bpp_id: snp.com
          bpp_uri: 'https://snp.com/ondc'
          transaction_id: T2
          message_id: M4
          city: 'std:080'
          country: IND
          timestamp: '2025-01-08T09:30:10.000Z'
          ttl: PT30S
        message:
          order:
            id: O1
            type: ILBN
            state: Accepted
            provider:
              id: P1
              locations:
                - id: L1
            items:
              - id: I1
                fulfillment_id: F2
                quantity:
                  count: 1
            billing:
              name: ONDC buyer
              address:
                name: 'my house or door or floor #'
                building: 'my building name or house #'
                locality: my street name
                city: Bengaluru
                state: Karnataka
                country: IND
                area_code: '560037'
              phone: '9886098860'
              email: nobody@nomail.com
              created_at: '2025-01-08T09:00:00.000Z'
              updated_at: '2025-01-08T09:00:00.000Z'
            fulfillments:
              - id: F2
                type: Self-Pickup
                '@ondc/org/TAT': PT2H
                start:
                  location:
                    id: L1
                    descriptor:
                      name: ABC Store
                    gps: '12.9563,77.6368'
                    address:
                      locality: Jayanagar
                      city: Bengaluru
                      area_code: '560076'
                      state: KA
                  contact:
                    phone: '9886098860'
                    email: nobody@nomail.com
                state:
                  descriptor:
                    code: Pending
                end:
                  person:
                    name: name_of_person
                  contact:
                    email: nobody@nomail.com
                    phone: '9886098860'
                  location:
                    gps: '12.4535,77.9283'
                    address:
                      name: 'my house or door or floor #'
                      building: 'my building name or house #'
                      locality: my street name
                      city: Bengaluru
                      state: Karnataka
                      country: IND
                      area_code: '560037'
            quote:
              price:
                currency: INR
                value: '68014.00'
              breakup:
                - '@ondc/org/item_id': I1
                  '@ondc/org/item_quantity':
                    count: 1
                  title: Apple iPhone 14
                  '@ondc/org/title_type': item
                  price:
                    currency: INR
                    value: '67999.00'
                  item:
                    price:
                      currency: INR
                      value: '67999.00'
                - '@ondc/org/item_id': I1
                  title: Tax
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '0.00'
                - '@ondc/org/item_id': F2
                  title: Delivery charges
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: 00.00
                - '@ondc/org/item_id': F2
                  title: Packing charges
                  '@ondc/org/title_type': packing
                  price:
                    currency: INR
                    value: '25.00'
                - '@ondc/org/item_id': I1
                  title: Discount
                  '@ondc/org/title_type': discount
                  price:
                    currency: INR
                    value: '-10.00'
              ttl: P1D
            payments:
              - id: '3'
                type: PART-PAYMENT
                tags:
                  - descriptor:
                      code: LINKED-PAYMENTS
                    list:
                      - descriptor:
                          code: pymnt-part-1
                        value: '1'
                      - descriptor:
                          code: pymnt-part-2
                        value: '2'
              - id: pymnt-part-1
                type: ON-ORDER
                status: PAID
                collected_by: BAP
                tags:
                  - descriptor:
                      code: ADV-DEPOSIT
                params:
                  amount: '2000.00'
                  currency: INR
                  transaction_id: payment-utr-1234
              - id: pymnt-part-2
                type: ON-FULFILLMENT
                status: NOT-PAID
                collected_by: BPP
                tags:
                  - descriptor:
                      code: FINAL-PAYMENT
                params:
                  amount: '66014.00'
                  currency: INR
            tags:
              - code: bpp_terms
                list:
                  - code: np_type
                    value: MSN
                  - code: tax_number
                    value: gst_number_of_sellerNP
                  - code: provider_tax_number
                    value: PAN_number_of_provider
                  - code: accept_bap_terms
                    value: 'Y'
              - code: bap_terms
                list:
                  - code: static_terms
                    value: >-
                      https://github.com/ONDC-Official/NP-Static-Terms/buyerNP_BNP/1.0/tc.pdf
                  - code: tax_number
                    value: gst_number_of_buyerNP
            created_at: '2025-01-08T09:30:00.000Z'
            updated_at: '2025-01-08T09:30:10.000Z'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        city_code: $.context.city
      inputs: {}
  - api: on_status
    action_id: on_status_pending
    owner: BPP
    responseFor: null
    unsolicited: true
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICByZXR1cm4gZGVmYXVsdFBheWxvYWQ7Cn0=
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'ONDC:RETINVL'
          action: on_status
          core_version: 1.2.5
          bap_id: bnp.com
          bap_uri: 'https://bnp.com/ondc'
          bpp_id: snp.com
          bpp_uri: 'https://snp.com/ondc'
          transaction_id: T2
          message_id: M12
          city: 'std:080'
          country: IND
          timestamp: '2025-01-08T10:00:30.000Z'
          ttl: PT30S
        message:
          order:
            id: O1
            type: ILBN
            state: In-progress
            provider:
              id: P1
              locations:
                - id: L1
            items:
              - id: I1
                fulfillment_id: F2
                quantity:
                  count: 1
            billing:
              name: ONDC buyer
              address:
                name: 'my house or door or floor #'
                building: 'my building name or house #'
                locality: my street name
                city: Bengaluru
                state: Karnataka
                country: IND
                area_code: '560037'
              email: nobody@nomail.com
              phone: '9886098860'
              created_at: '2025-01-08T09:00:00.000Z'
              updated_at: '2025-01-08T09:00:00.000Z'
            fulfillments:
              - id: F1
                '@ondc/org/provider_name': LSP or Provider name
                type: Delivery
                tracking: false
                '@ondc/org/TAT': PT2H
                state:
                  descriptor:
                    code: Agent-assigned
                start:
                  location:
                    descriptor:
                      name: ABC Store
                    gps: '12.9675,77.7496'
                    address:
                      locality: Jayanagar
                      city: Bengaluru
                      area_code: '560076'
                      state: KA
                  time:
                    timestamp: '2025-01-08T10:00:30.000Z'
                  contact:
                    phone: '9886098860'
                    email: nobody@nomail.com
                end:
                  location:
                    gps: '12.453544,77.928379'
                    address:
                      name: 'my house or door or floor #'
                      building: 'my building name or house #'
                      locality: my street name
                      city: Bengaluru
                      state: Karnataka
                      country: IND
                      area_code: '560037'
                  time:
                    timestamp: '2025-01-08T10:30:00.000Z'
                  person:
                    name: name_of_person
                  contact:
                    phone: '9886098860'
                agent:
                  name: agent_name
                  phone: '9886098860'
                tags:
                  - code: routing
                    list:
                      - code: type
                        value: P2P
                  - code: tracking
                    list:
                      - code: gps_enabled
                        value: 'yes'
                      - code: url_enabled
                        value: 'no'
                      - code: url
                        value: 'https://snp.com/ondc/tracking_url'
            quote:
              price:
                currency: INR
                value: '68014.00'
              breakup:
                - '@ondc/org/item_id': I1
                  '@ondc/org/item_quantity':
                    count: 1
                  title: Apple iPhone 14
                  '@ondc/org/title_type': item
                  price:
                    currency: INR
                    value: '67999.00'
                  item:
                    price:
                      currency: INR
                      value: '67999.00'
                - '@ondc/org/item_id': I1
                  title: Tax
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '0.00'
                - '@ondc/org/item_id': F2
                  title: Delivery charges
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: 00.00
                - '@ondc/org/item_id': F2
                  title: Packing charges
                  '@ondc/org/title_type': packing
                  price:
                    currency: INR
                    value: '25.00'
                - '@ondc/org/item_id': I1
                  title: Discount
                  '@ondc/org/title_type': discount
                  price:
                    currency: INR
                    value: '-10.00'
              ttl: P1D
            payments:
              - id: '3'
                type: PART-PAYMENT
                tags:
                  - descriptor:
                      code: LINKED-PAYMENTS
                    list:
                      - descriptor:
                          code: pymnt-part-1
                        value: '1'
                      - descriptor:
                          code: pymnt-part-2
                        value: '2'
              - id: pymnt-part-1
                type: ON-ORDER
                status: PAID
                collected_by: BAP
                tags:
                  - descriptor:
                      code: ADV-DEPOSIT
                params:
                  amount: '2000.00'
                  currency: INR
                  transaction_id: payment-utr-1234
              - id: pymnt-part-2
                type: ON-FULFILLMENT
                status: PAID
                collected_by: BPP
                tags:
                  - descriptor:
                      code: FINAL-PAYMENT
                params:
                  amount: '66014.00'
                  currency: INR
                  transaction_id: payment-utr-5678
            documents:
              - url: 'https://invoice_url'
                label: Invoice
            created_at: '2025-01-08T09:30:00.000Z'
            updated_at: '2025-01-08T10:00:30.000Z'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        city_code: $.context.city
      inputs:
        id: ExampleInputId
        jsonSchema:
          $schema: 'http://json-schema.org/draft-07/schema#'
          type: object
          properties:
            email:
              type: string
              format: email
              minLength: 5
              maxLength: 50
              description: User's email address
            age:
              type: integer
              minimum: 18
              maximum: 120
              description: User's age
            password:
              type: string
              minLength: 8
              pattern: '^(?=.*[A-Z])(?=.*[0-9]).+$'
              description: Must contain uppercase and number
            website:
              type: string
              format: uri
            country:
              type: string
              enum:
                - US
                - UK
                - CA
                - AU
          required:
            - email
            - password
          additionalProperties: false
  - api: on_status
    action_id: on_status_order_packed
    owner: BPP
    responseFor: null
    unsolicited: true
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICByZXR1cm4gZGVmYXVsdFBheWxvYWQ7Cn0=
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'ONDC:RETINVL'
          action: on_status
          core_version: 1.2.5
          bap_id: bnp.com
          bap_uri: 'https://bnp.com/ondc'
          bpp_id: snp.com
          bpp_uri: 'https://snp.com/ondc'
          transaction_id: T2
          message_id: M12
          city: 'std:080'
          country: IND
          timestamp: '2025-01-08T10:00:30.000Z'
          ttl: PT30S
        message:
          order:
            id: O1
            type: ILBN
            state: In-progress
            provider:
              id: P1
              locations:
                - id: L1
            items:
              - id: I1
                fulfillment_id: F2
                quantity:
                  count: 1
            billing:
              name: ONDC buyer
              address:
                name: 'my house or door or floor #'
                building: 'my building name or house #'
                locality: my street name
                city: Bengaluru
                state: Karnataka
                country: IND
                area_code: '560037'
              email: nobody@nomail.com
              phone: '9886098860'
              created_at: '2025-01-08T09:00:00.000Z'
              updated_at: '2025-01-08T09:00:00.000Z'
            fulfillments:
              - id: F1
                '@ondc/org/provider_name': LSP or Provider name
                type: Delivery
                tracking: false
                '@ondc/org/TAT': PT2H
                state:
                  descriptor:
                    code: Agent-assigned
                start:
                  location:
                    descriptor:
                      name: ABC Store
                    gps: '12.9675,77.7496'
                    address:
                      locality: Jayanagar
                      city: Bengaluru
                      area_code: '560076'
                      state: KA
                  time:
                    timestamp: '2025-01-08T10:00:30.000Z'
                  contact:
                    phone: '9886098860'
                    email: nobody@nomail.com
                end:
                  location:
                    gps: '12.453544,77.928379'
                    address:
                      name: 'my house or door or floor #'
                      building: 'my building name or house #'
                      locality: my street name
                      city: Bengaluru
                      state: Karnataka
                      country: IND
                      area_code: '560037'
                  time:
                    timestamp: '2025-01-08T10:30:00.000Z'
                  person:
                    name: name_of_person
                  contact:
                    phone: '9886098860'
                agent:
                  name: agent_name
                  phone: '9886098860'
                tags:
                  - code: routing
                    list:
                      - code: type
                        value: P2P
                  - code: tracking
                    list:
                      - code: gps_enabled
                        value: 'yes'
                      - code: url_enabled
                        value: 'no'
                      - code: url
                        value: 'https://snp.com/ondc/tracking_url'
            quote:
              price:
                currency: INR
                value: '68014.00'
              breakup:
                - '@ondc/org/item_id': I1
                  '@ondc/org/item_quantity':
                    count: 1
                  title: Apple iPhone 14
                  '@ondc/org/title_type': item
                  price:
                    currency: INR
                    value: '67999.00'
                  item:
                    price:
                      currency: INR
                      value: '67999.00'
                - '@ondc/org/item_id': I1
                  title: Tax
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '0.00'
                - '@ondc/org/item_id': F2
                  title: Delivery charges
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: 00.00
                - '@ondc/org/item_id': F2
                  title: Packing charges
                  '@ondc/org/title_type': packing
                  price:
                    currency: INR
                    value: '25.00'
                - '@ondc/org/item_id': I1
                  title: Discount
                  '@ondc/org/title_type': discount
                  price:
                    currency: INR
                    value: '-10.00'
              ttl: P1D
            payments:
              - id: '3'
                type: PART-PAYMENT
                tags:
                  - descriptor:
                      code: LINKED-PAYMENTS
                    list:
                      - descriptor:
                          code: pymnt-part-1
                        value: '1'
                      - descriptor:
                          code: pymnt-part-2
                        value: '2'
              - id: pymnt-part-1
                type: ON-ORDER
                status: PAID
                collected_by: BAP
                tags:
                  - descriptor:
                      code: ADV-DEPOSIT
                params:
                  amount: '2000.00'
                  currency: INR
                  transaction_id: payment-utr-1234
              - id: pymnt-part-2
                type: ON-FULFILLMENT
                status: PAID
                collected_by: BPP
                tags:
                  - descriptor:
                      code: FINAL-PAYMENT
                params:
                  amount: '66014.00'
                  currency: INR
                  transaction_id: payment-utr-5678
            documents:
              - url: 'https://invoice_url'
                label: Invoice
            created_at: '2025-01-08T09:30:00.000Z'
            updated_at: '2025-01-08T10:00:30.000Z'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        city_code: $.context.city
      inputs:
        id: ExampleInputId
        jsonSchema:
          $schema: 'http://json-schema.org/draft-07/schema#'
          type: object
          properties:
            email:
              type: string
              format: email
              minLength: 5
              maxLength: 50
              description: User's email address
            age:
              type: integer
              minimum: 18
              maximum: 120
              description: User's age
            password:
              type: string
              minLength: 8
              pattern: '^(?=.*[A-Z])(?=.*[0-9]).+$'
              description: Must contain uppercase and number
            website:
              type: string
              format: uri
            country:
              type: string
              enum:
                - US
                - UK
                - CA
                - AU
          required:
            - email
            - password
          additionalProperties: false
  - api: on_status
    action_id: on_status_agent_assigned
    owner: BPP
    responseFor: null
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICByZXR1cm4gZGVmYXVsdFBheWxvYWQ7Cn0=
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'ONDC:RETINVL'
          action: on_status
          core_version: 1.2.5
          bap_id: bnp.com
          bap_uri: 'https://bnp.com/ondc'
          bpp_id: snp.com
          bpp_uri: 'https://snp.com/ondc'
          transaction_id: T2
          message_id: M12
          city: 'std:080'
          country: IND
          timestamp: '2025-01-08T10:00:30.000Z'
          ttl: PT30S
        message:
          order:
            id: O1
            type: ILBN
            state: In-progress
            provider:
              id: P1
              locations:
                - id: L1
            items:
              - id: I1
                fulfillment_id: F2
                quantity:
                  count: 1
            billing:
              name: ONDC buyer
              address:
                name: 'my house or door or floor #'
                building: 'my building name or house #'
                locality: my street name
                city: Bengaluru
                state: Karnataka
                country: IND
                area_code: '560037'
              email: nobody@nomail.com
              phone: '9886098860'
              created_at: '2025-01-08T09:00:00.000Z'
              updated_at: '2025-01-08T09:00:00.000Z'
            fulfillments:
              - id: F1
                '@ondc/org/provider_name': LSP or Provider name
                type: Delivery
                tracking: false
                '@ondc/org/TAT': PT2H
                state:
                  descriptor:
                    code: Agent-assigned
                start:
                  location:
                    descriptor:
                      name: ABC Store
                    gps: '12.9675,77.7496'
                    address:
                      locality: Jayanagar
                      city: Bengaluru
                      area_code: '560076'
                      state: KA
                  time:
                    timestamp: '2025-01-08T10:00:30.000Z'
                  contact:
                    phone: '9886098860'
                    email: nobody@nomail.com
                end:
                  location:
                    gps: '12.453544,77.928379'
                    address:
                      name: 'my house or door or floor #'
                      building: 'my building name or house #'
                      locality: my street name
                      city: Bengaluru
                      state: Karnataka
                      country: IND
                      area_code: '560037'
                  time:
                    timestamp: '2025-01-08T10:30:00.000Z'
                  person:
                    name: name_of_person
                  contact:
                    phone: '9886098860'
                agent:
                  name: agent_name
                  phone: '9886098860'
                tags:
                  - code: routing
                    list:
                      - code: type
                        value: P2P
                  - code: tracking
                    list:
                      - code: gps_enabled
                        value: 'yes'
                      - code: url_enabled
                        value: 'no'
                      - code: url
                        value: 'https://snp.com/ondc/tracking_url'
            quote:
              price:
                currency: INR
                value: '68014.00'
              breakup:
                - '@ondc/org/item_id': I1
                  '@ondc/org/item_quantity':
                    count: 1
                  title: Apple iPhone 14
                  '@ondc/org/title_type': item
                  price:
                    currency: INR
                    value: '67999.00'
                  item:
                    price:
                      currency: INR
                      value: '67999.00'
                - '@ondc/org/item_id': I1
                  title: Tax
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '0.00'
                - '@ondc/org/item_id': F2
                  title: Delivery charges
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: 00.00
                - '@ondc/org/item_id': F2
                  title: Packing charges
                  '@ondc/org/title_type': packing
                  price:
                    currency: INR
                    value: '25.00'
                - '@ondc/org/item_id': I1
                  title: Discount
                  '@ondc/org/title_type': discount
                  price:
                    currency: INR
                    value: '-10.00'
              ttl: P1D
            payments:
              - id: '3'
                type: PART-PAYMENT
                tags:
                  - descriptor:
                      code: LINKED-PAYMENTS
                    list:
                      - descriptor:
                          code: pymnt-part-1
                        value: '1'
                      - descriptor:
                          code: pymnt-part-2
                        value: '2'
              - id: pymnt-part-1
                type: ON-ORDER
                status: PAID
                collected_by: BAP
                tags:
                  - descriptor:
                      code: ADV-DEPOSIT
                params:
                  amount: '2000.00'
                  currency: INR
                  transaction_id: payment-utr-1234
              - id: pymnt-part-2
                type: ON-FULFILLMENT
                status: PAID
                collected_by: BPP
                tags:
                  - descriptor:
                      code: FINAL-PAYMENT
                params:
                  amount: '66014.00'
                  currency: INR
                  transaction_id: payment-utr-5678
            documents:
              - url: 'https://invoice_url'
                label: Invoice
            created_at: '2025-01-08T09:30:00.000Z'
            updated_at: '2025-01-08T10:00:30.000Z'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        city_code: $.context.city
      inputs:
        id: ExampleInputId
        jsonSchema:
          $schema: 'http://json-schema.org/draft-07/schema#'
          type: object
          properties:
            email:
              type: string
              format: email
              minLength: 5
              maxLength: 50
              description: User's email address
            age:
              type: integer
              minimum: 18
              maximum: 120
              description: User's age
            password:
              type: string
              minLength: 8
              pattern: '^(?=.*[A-Z])(?=.*[0-9]).+$'
              description: Must contain uppercase and number
            website:
              type: string
              format: uri
            country:
              type: string
              enum:
                - US
                - UK
                - CA
                - AU
          required:
            - email
            - password
          additionalProperties: false
  - api: track
    action_id: track_1
    owner: BAP
    responseFor: null
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICByZXR1cm4gZGVmYXVsdFBheWxvYWQ7Cn0=
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'ONDC:RETINVL'
          action: track
          timestamp: '2026-02-23T11:36:47.075Z'
          transaction_id: 3d642d45-ec0a-4555-a115-da3a2145b66d
          message_id: 36cbc0f1-c29c-4da9-a6ea-a5732767f758
          bap_id: bap.example.com
          bap_uri: 'https://bap.example.com'
          ttl: PT30S
          bpp_id: bpp.example.com
          bpp_uri: 'https://bpp.example.com'
          country: IND
          city: '*'
          core_version: 1.2.5
        message: {}
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        city_code: $.context.city
      inputs:
        id: ExampleInputId
        jsonSchema:
          $schema: 'http://json-schema.org/draft-07/schema#'
          type: object
          properties:
            email:
              type: string
              format: email
              minLength: 5
              maxLength: 50
              description: User's email address
            age:
              type: integer
              minimum: 18
              maximum: 120
              description: User's age
            password:
              type: string
              minLength: 8
              pattern: '^(?=.*[A-Z])(?=.*[0-9]).+$'
              description: Must contain uppercase and number
            website:
              type: string
              format: uri
            country:
              type: string
              enum:
                - US
                - UK
                - CA
                - AU
          required:
            - email
            - password
          additionalProperties: false
  - api: on_track
    action_id: on_track_1
    owner: BPP
    responseFor: track_1
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICByZXR1cm4gZGVmYXVsdFBheWxvYWQ7Cn0=
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'ONDC:RETINVL'
          action: on_track
          timestamp: '2026-02-23T11:37:00.177Z'
          transaction_id: 3d642d45-ec0a-4555-a115-da3a2145b66d
          message_id: 9bfc60e4-abfb-4a20-bbba-65ab7e96c1d7
          bap_id: bap.example.com
          bap_uri: 'https://bap.example.com'
          ttl: PT30S
          bpp_id: bpp.example.com
          bpp_uri: 'https://bpp.example.com'
          country: IND
          city: '*'
          core_version: 1.2.5
        message: {}
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        city_code: $.context.city
      inputs:
        id: ExampleInputId
        jsonSchema:
          $schema: 'http://json-schema.org/draft-07/schema#'
          type: object
          properties:
            email:
              type: string
              format: email
              minLength: 5
              maxLength: 50
              description: User's email address
            age:
              type: integer
              minimum: 18
              maximum: 120
              description: User's age
            password:
              type: string
              minLength: 8
              pattern: '^(?=.*[A-Z])(?=.*[0-9]).+$'
              description: Must contain uppercase and number
            website:
              type: string
              format: uri
            country:
              type: string
              enum:
                - US
                - UK
                - CA
                - AU
          required:
            - email
            - password
          additionalProperties: false
  - api: on_status
    action_id: on_status_order_picked_up
    owner: BPP
    responseFor: null
    unsolicited: true
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICByZXR1cm4gZGVmYXVsdFBheWxvYWQ7Cn0=
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'ONDC:RETINVL'
          action: on_status
          core_version: 1.2.5
          bap_id: bnp.com
          bap_uri: 'https://bnp.com/ondc'
          bpp_id: snp.com
          bpp_uri: 'https://snp.com/ondc'
          transaction_id: T2
          message_id: M12
          city: 'std:080'
          country: IND
          timestamp: '2025-01-08T10:00:30.000Z'
          ttl: PT30S
        message:
          order:
            id: O1
            type: ILBN
            state: In-progress
            provider:
              id: P1
              locations:
                - id: L1
            items:
              - id: I1
                fulfillment_id: F2
                quantity:
                  count: 1
            billing:
              name: ONDC buyer
              address:
                name: 'my house or door or floor #'
                building: 'my building name or house #'
                locality: my street name
                city: Bengaluru
                state: Karnataka
                country: IND
                area_code: '560037'
              email: nobody@nomail.com
              phone: '9886098860'
              created_at: '2025-01-08T09:00:00.000Z'
              updated_at: '2025-01-08T09:00:00.000Z'
            fulfillments:
              - id: F1
                '@ondc/org/provider_name': LSP or Provider name
                type: Delivery
                tracking: false
                '@ondc/org/TAT': PT2H
                state:
                  descriptor:
                    code: ''
                start:
                  location:
                    descriptor:
                      name: ABC Store
                    gps: '12.9675,77.7496'
                    address:
                      locality: Jayanagar
                      city: Bengaluru
                      area_code: '560076'
                      state: KA
                  time:
                    timestamp: '2025-01-08T10:00:30.000Z'
                  contact:
                    phone: '9886098860'
                    email: nobody@nomail.com
                end:
                  location:
                    gps: '12.453544,77.928379'
                    address:
                      name: 'my house or door or floor #'
                      building: 'my building name or house #'
                      locality: my street name
                      city: Bengaluru
                      state: Karnataka
                      country: IND
                      area_code: '560037'
                  time:
                    timestamp: '2025-01-08T10:30:00.000Z'
                  person:
                    name: name_of_person
                  contact:
                    phone: '9886098860'
                agent:
                  name: agent_name
                  phone: '9886098860'
                tags:
                  - code: routing
                    list:
                      - code: type
                        value: P2P
                  - code: tracking
                    list:
                      - code: gps_enabled
                        value: 'yes'
                      - code: url_enabled
                        value: 'no'
                      - code: url
                        value: 'https://snp.com/ondc/tracking_url'
            quote:
              price:
                currency: INR
                value: '68014.00'
              breakup:
                - '@ondc/org/item_id': I1
                  '@ondc/org/item_quantity':
                    count: 1
                  title: Apple iPhone 14
                  '@ondc/org/title_type': item
                  price:
                    currency: INR
                    value: '67999.00'
                  item:
                    price:
                      currency: INR
                      value: '67999.00'
                - '@ondc/org/item_id': I1
                  title: Tax
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '0.00'
                - '@ondc/org/item_id': F2
                  title: Delivery charges
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: 00.00
                - '@ondc/org/item_id': F2
                  title: Packing charges
                  '@ondc/org/title_type': packing
                  price:
                    currency: INR
                    value: '25.00'
                - '@ondc/org/item_id': I1
                  title: Discount
                  '@ondc/org/title_type': discount
                  price:
                    currency: INR
                    value: '-10.00'
              ttl: P1D
            payments:
              - id: '3'
                type: PART-PAYMENT
                tags:
                  - descriptor:
                      code: LINKED-PAYMENTS
                    list:
                      - descriptor:
                          code: pymnt-part-1
                        value: '1'
                      - descriptor:
                          code: pymnt-part-2
                        value: '2'
              - id: pymnt-part-1
                type: ON-ORDER
                status: PAID
                collected_by: BAP
                tags:
                  - descriptor:
                      code: ADV-DEPOSIT
                params:
                  amount: '2000.00'
                  currency: INR
                  transaction_id: payment-utr-1234
              - id: pymnt-part-2
                type: ON-FULFILLMENT
                status: PAID
                collected_by: BPP
                tags:
                  - descriptor:
                      code: FINAL-PAYMENT
                params:
                  amount: '66014.00'
                  currency: INR
                  transaction_id: payment-utr-5678
            documents:
              - url: 'https://invoice_url'
                label: Invoice
            created_at: '2025-01-08T09:30:00.000Z'
            updated_at: '2025-01-08T10:00:30.000Z'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        city_code: $.context.city
      inputs:
        id: ExampleInputId
        jsonSchema:
          $schema: 'http://json-schema.org/draft-07/schema#'
          type: object
          properties:
            email:
              type: string
              format: email
              minLength: 5
              maxLength: 50
              description: User's email address
            age:
              type: integer
              minimum: 18
              maximum: 120
              description: User's age
            password:
              type: string
              minLength: 8
              pattern: '^(?=.*[A-Z])(?=.*[0-9]).+$'
              description: Must contain uppercase and number
            website:
              type: string
              format: uri
            country:
              type: string
              enum:
                - US
                - UK
                - CA
                - AU
          required:
            - email
            - password
          additionalProperties: false
  - api: on_status
    action_id: on_status_out_for_delivery
    owner: BPP
    responseFor: null
    unsolicited: true
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICByZXR1cm4gZGVmYXVsdFBheWxvYWQ7Cn0=
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'ONDC:RETINVL'
          action: on_status
          core_version: 1.2.5
          bap_id: bnp.com
          bap_uri: 'https://bnp.com/ondc'
          bpp_id: snp.com
          bpp_uri: 'https://snp.com/ondc'
          transaction_id: T2
          message_id: M12
          city: 'std:080'
          country: IND
          timestamp: '2025-01-08T10:00:30.000Z'
          ttl: PT30S
        message:
          order:
            id: O1
            type: ILBN
            state: In-progress
            provider:
              id: P1
              locations:
                - id: L1
            items:
              - id: I1
                fulfillment_id: F2
                quantity:
                  count: 1
            billing:
              name: ONDC buyer
              address:
                name: 'my house or door or floor #'
                building: 'my building name or house #'
                locality: my street name
                city: Bengaluru
                state: Karnataka
                country: IND
                area_code: '560037'
              email: nobody@nomail.com
              phone: '9886098860'
              created_at: '2025-01-08T09:00:00.000Z'
              updated_at: '2025-01-08T09:00:00.000Z'
            fulfillments:
              - id: F1
                '@ondc/org/provider_name': LSP or Provider name
                type: Delivery
                tracking: false
                '@ondc/org/TAT': PT2H
                state:
                  descriptor:
                    code: Out-for-delivery
                start:
                  location:
                    descriptor:
                      name: ABC Store
                    gps: '12.9675,77.7496'
                    address:
                      locality: Jayanagar
                      city: Bengaluru
                      area_code: '560076'
                      state: KA
                  time:
                    timestamp: '2025-01-08T10:00:30.000Z'
                  contact:
                    phone: '9886098860'
                    email: nobody@nomail.com
                end:
                  location:
                    gps: '12.453544,77.928379'
                    address:
                      name: 'my house or door or floor #'
                      building: 'my building name or house #'
                      locality: my street name
                      city: Bengaluru
                      state: Karnataka
                      country: IND
                      area_code: '560037'
                  time:
                    timestamp: '2025-01-08T10:30:00.000Z'
                  person:
                    name: name_of_person
                  contact:
                    phone: '9886098860'
                agent:
                  name: agent_name
                  phone: '9886098860'
                tags:
                  - code: routing
                    list:
                      - code: type
                        value: P2P
                  - code: tracking
                    list:
                      - code: gps_enabled
                        value: 'yes'
                      - code: url_enabled
                        value: 'no'
                      - code: url
                        value: 'https://snp.com/ondc/tracking_url'
            quote:
              price:
                currency: INR
                value: '68014.00'
              breakup:
                - '@ondc/org/item_id': I1
                  '@ondc/org/item_quantity':
                    count: 1
                  title: Apple iPhone 14
                  '@ondc/org/title_type': item
                  price:
                    currency: INR
                    value: '67999.00'
                  item:
                    price:
                      currency: INR
                      value: '67999.00'
                - '@ondc/org/item_id': I1
                  title: Tax
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '0.00'
                - '@ondc/org/item_id': F2
                  title: Delivery charges
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: 00.00
                - '@ondc/org/item_id': F2
                  title: Packing charges
                  '@ondc/org/title_type': packing
                  price:
                    currency: INR
                    value: '25.00'
                - '@ondc/org/item_id': I1
                  title: Discount
                  '@ondc/org/title_type': discount
                  price:
                    currency: INR
                    value: '-10.00'
              ttl: P1D
            payments:
              - id: '3'
                type: PART-PAYMENT
                tags:
                  - descriptor:
                      code: LINKED-PAYMENTS
                    list:
                      - descriptor:
                          code: pymnt-part-1
                        value: '1'
                      - descriptor:
                          code: pymnt-part-2
                        value: '2'
              - id: pymnt-part-1
                type: ON-ORDER
                status: PAID
                collected_by: BAP
                tags:
                  - descriptor:
                      code: ADV-DEPOSIT
                params:
                  amount: '2000.00'
                  currency: INR
                  transaction_id: payment-utr-1234
              - id: pymnt-part-2
                type: ON-FULFILLMENT
                status: PAID
                collected_by: BPP
                tags:
                  - descriptor:
                      code: FINAL-PAYMENT
                params:
                  amount: '66014.00'
                  currency: INR
                  transaction_id: payment-utr-5678
            documents:
              - url: 'https://invoice_url'
                label: Invoice
            created_at: '2025-01-08T09:30:00.000Z'
            updated_at: '2025-01-08T10:00:30.000Z'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        city_code: $.context.city
      inputs:
        id: ExampleInputId
        jsonSchema:
          $schema: 'http://json-schema.org/draft-07/schema#'
          type: object
          properties:
            email:
              type: string
              format: email
              minLength: 5
              maxLength: 50
              description: User's email address
            age:
              type: integer
              minimum: 18
              maximum: 120
              description: User's age
            password:
              type: string
              minLength: 8
              pattern: '^(?=.*[A-Z])(?=.*[0-9]).+$'
              description: Must contain uppercase and number
            website:
              type: string
              format: uri
            country:
              type: string
              enum:
                - US
                - UK
                - CA
                - AU
          required:
            - email
            - password
          additionalProperties: false
  - api: on_status
    action_id: on_status_order_delivered
    owner: BPP
    responseFor: null
    unsolicited: false
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICByZXR1cm4gZGVmYXVsdFBheWxvYWQ7Cn0=
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: 'ONDC:RETINVL'
          action: on_status
          core_version: 1.2.5
          bap_id: bnp.com
          bap_uri: 'https://bnp.com/ondc'
          bpp_id: snp.com
          bpp_uri: 'https://snp.com/ondc'
          transaction_id: T2
          message_id: M12
          city: 'std:080'
          country: IND
          timestamp: '2025-01-08T10:00:30.000Z'
          ttl: PT30S
        message:
          order:
            id: O1
            type: ILBN
            state: Completed
            provider:
              id: P1
              locations:
                - id: L1
            items:
              - id: I1
                fulfillment_id: F2
                quantity:
                  count: 1
            billing:
              name: ONDC buyer
              address:
                name: 'my house or door or floor #'
                building: 'my building name or house #'
                locality: my street name
                city: Bengaluru
                state: Karnataka
                country: IND
                area_code: '560037'
              email: nobody@nomail.com
              phone: '9886098860'
              created_at: '2025-01-08T09:00:00.000Z'
              updated_at: '2025-01-08T09:00:00.000Z'
            fulfillments:
              - id: F1
                '@ondc/org/provider_name': LSP or Provider name
                type: Delivery
                tracking: false
                '@ondc/org/TAT': PT2H
                state:
                  descriptor:
                    code: Agent-assigned
                start:
                  location:
                    descriptor:
                      name: ABC Store
                    gps: '12.9675,77.7496'
                    address:
                      locality: Jayanagar
                      city: Bengaluru
                      area_code: '560076'
                      state: KA
                  time:
                    timestamp: '2025-01-08T10:00:30.000Z'
                  contact:
                    phone: '9886098860'
                    email: nobody@nomail.com
                end:
                  location:
                    gps: '12.453544,77.928379'
                    address:
                      name: 'my house or door or floor #'
                      building: 'my building name or house #'
                      locality: my street name
                      city: Bengaluru
                      state: Karnataka
                      country: IND
                      area_code: '560037'
                  time:
                    timestamp: '2025-01-08T10:30:00.000Z'
                  person:
                    name: name_of_person
                  contact:
                    phone: '9886098860'
                agent:
                  name: agent_name
                  phone: '9886098860'
                tags:
                  - code: routing
                    list:
                      - code: type
                        value: P2P
                  - code: tracking
                    list:
                      - code: gps_enabled
                        value: 'yes'
                      - code: url_enabled
                        value: 'no'
                      - code: url
                        value: 'https://snp.com/ondc/tracking_url'
            quote:
              price:
                currency: INR
                value: '68014.00'
              breakup:
                - '@ondc/org/item_id': I1
                  '@ondc/org/item_quantity':
                    count: 1
                  title: Apple iPhone 14
                  '@ondc/org/title_type': item
                  price:
                    currency: INR
                    value: '67999.00'
                  item:
                    price:
                      currency: INR
                      value: '67999.00'
                - '@ondc/org/item_id': I1
                  title: Tax
                  '@ondc/org/title_type': tax
                  price:
                    currency: INR
                    value: '0.00'
                - '@ondc/org/item_id': F2
                  title: Delivery charges
                  '@ondc/org/title_type': delivery
                  price:
                    currency: INR
                    value: 00.00
                - '@ondc/org/item_id': F2
                  title: Packing charges
                  '@ondc/org/title_type': packing
                  price:
                    currency: INR
                    value: '25.00'
                - '@ondc/org/item_id': I1
                  title: Discount
                  '@ondc/org/title_type': discount
                  price:
                    currency: INR
                    value: '-10.00'
              ttl: P1D
            payments:
              - id: '3'
                type: PART-PAYMENT
                tags:
                  - descriptor:
                      code: LINKED-PAYMENTS
                    list:
                      - descriptor:
                          code: pymnt-part-1
                        value: '1'
                      - descriptor:
                          code: pymnt-part-2
                        value: '2'
              - id: pymnt-part-1
                type: ON-ORDER
                status: PAID
                collected_by: BAP
                tags:
                  - descriptor:
                      code: ADV-DEPOSIT
                params:
                  amount: '2000.00'
                  currency: INR
                  transaction_id: payment-utr-1234
              - id: pymnt-part-2
                type: ON-FULFILLMENT
                status: PAID
                collected_by: BPP
                tags:
                  - descriptor:
                      code: FINAL-PAYMENT
                params:
                  amount: '66014.00'
                  currency: INR
                  transaction_id: payment-utr-5678
            documents:
              - url: 'https://invoice_url'
                label: Invoice
            created_at: '2025-01-08T09:30:00.000Z'
            updated_at: '2025-01-08T10:00:30.000Z'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        city_code: $.context.city
      inputs:
        id: ExampleInputId
        jsonSchema:
          $schema: 'http://json-schema.org/draft-07/schema#'
          type: object
          properties:
            email:
              type: string
              format: email
              minLength: 5
              maxLength: 50
              description: User's email address
            age:
              type: integer
              minimum: 18
              maximum: 120
              description: User's age
            password:
              type: string
              minLength: 8
              pattern: '^(?=.*[A-Z])(?=.*[0-9]).+$'
              description: Must contain uppercase and number
            website:
              type: string
              format: uri
            country:
              type: string
              enum:
                - US
                - UK
                - CA
                - AU
          required:
            - email
            - password
          additionalProperties: false
transaction_history:
  - action_id: init_1
    payload:
      context:
        domain: 'ONDC:RETINVL'
        action: init
        timestamp: '2026-02-23T18:01:35.655Z'
        transaction_id: 3d642d45-ec0a-4555-a115-da3a2145b66d
        message_id: d145c4ba-3472-48ed-80e4-8fe4a2dff938
        bap_id: bap.example.com
        bap_uri: 'https://bap.example.com'
        ttl: PT30S
        bpp_id: bpp.example.com
        bpp_uri: 'https://bpp.example.com'
        country: IND
        city: 'std:080'
        core_version: 1.2.5
      message:
        order:
          type: ILBN
          provider:
            id: P1
            locations:
              - id: L1
          items:
            - id: I1
              descriptor:
                code: '3:GTIN#'
              quantity:
                count: 1
              price:
                estimated_value: '11000'
          fulfillments:
            - id: F1
              type: Delivery
              end:
                location:
                  gps: '19.129076,72.825803'
                  address:
                    area_code: '400053'
    action: init
    saved_info: {}
  - action_id: on_init_1
    payload:
      context:
        domain: 'ONDC:RETINVL'
        action: on_init
        timestamp: '2026-02-23T18:01:39.756Z'
        transaction_id: 3d642d45-ec0a-4555-a115-da3a2145b66d
        message_id: d145c4ba-3472-48ed-80e4-8fe4a2dff938
        bap_id: bap.example.com
        bap_uri: 'https://bap.example.com'
        ttl: PT30S
        bpp_id: bpp.example.com
        bpp_uri: 'https://bpp.example.com'
        country: IND
        city: 'std:080'
        core_version: 1.2.5
      message:
        order:
          type: ILBN
          provider:
            id: P1
            locations:
              - id: L1
          items:
            - id: I1
              fulfillment_id: F1
              descriptor:
                code: '3:GTIN#'
              quantity:
                count:
                  count: 1
          fulfillments:
            - id: F1
              type: Delivery
              tracking: false
              end:
                location:
                  gps: '12.4535,77.9283'
                  address:
                    area_code: '560037'
            - id: F2
              type: Self-Pickup
          quote:
            breakup:
              - '@ondc/org/item_id': I1
                '@ondc/org/item_quantity':
                  count: 1
                title: Apple Mobile Phone Standard
                '@ondc/org/title_type': item
                price:
                  currency: INR
                  value: '10841.00'
                item:
                  price:
                    currency: INR
                    value: '10841'
              - '@ondc/org/item_id': F1
                title: Delivery charges
                '@ondc/org/title_type': delivery
                price:
                  currency: INR
                  value: '493.75'
              - '@ondc/org/item_id': F1
                title: Convenience Fee
                '@ondc/org/title_type': misc
                price:
                  currency: INR
                  value: '3.00'
            price:
              currency: INR
              value: '11337.75'
            ttl: P1D
          payments:
            - id: '3'
              type: PART-PAYMENT
              tags:
                - descriptor:
                    code: LINKED-PAYMENTS
                  list:
                    - descriptor:
                        code: pymnt-part-1
                      value: '1'
                    - descriptor:
                        code: pymnt-part-2
                      value: '2'
            - id: pymnt-part-1
              type: ON-ORDER
              status: NOT-PAID
              collected_by: BAP
              tags:
                - descriptor:
                    code: ADV-DEPOSIT
              params:
                amount: '123'
                currency: INR
            - id: pymnt-part-2
              type: ON-FULFILLMENT
              status: NOT-PAID
              collected_by: BPP
              tags:
                - descriptor:
                    code: FINAL-PAYMENT
              params:
                amount: '11214.75'
                currency: INR
    action: on_init
    saved_info: {}
  - action_id: confirm_1
    payload:
      context:
        domain: 'ONDC:RETINVL'
        action: confirm
        timestamp: '2026-02-23T18:01:42.263Z'
        transaction_id: 3d642d45-ec0a-4555-a115-da3a2145b66d
        message_id: 5c14aeda-67fc-4ed9-965c-9dd77e2a124a
        bap_id: bap.example.com
        bap_uri: 'https://bap.example.com'
        ttl: PT30S
        bpp_id: bpp.example.com
        bpp_uri: 'https://bpp.example.com'
        country: IND
        city: 'std:080'
        core_version: 1.2.5
      message:
        order:
          type: ILBN
          id: 95cea752-65f3-4c6a-833f-a77c55acb277
          state: Created
          provider:
            id: P1
            locations:
              - id: L1
          items:
            - id: I1
              fulfillment_id: F1
              quantity:
                count: 1
          billing:
            name: ONDC buyer
            address:
              name: My Address
              building: My Building
              locality: My Street
              city: Bengaluru
              state: Karnataka
              country: IND
              area_code: '560002'
            phone: '9886098860'
            email: buyer@test.com
            created_at: '2026-02-23T18:01:42.263Z'
            updated_at: '2026-02-23T18:01:42.263Z'
          fulfillments:
            - id: F1
              type: Delivery
              tracking: false
              end:
                person:
                  name: Customer
                contact:
                  phone: '9886098860'
                  email: buyer@test.com
                location:
                  gps: '12.4535,77.9283'
                  address:
                    name: My Address
                    building: My Building
                    locality: My Street
                    city: Bengaluru
                    state: Karnataka
                    country: IND
                    area_code: '560002'
          payments:
            - id: '3'
              type: PART-PAYMENT
              tags:
                - descriptor:
                    code: LINKED-PAYMENTS
                  list:
                    - descriptor:
                        code: pymnt-part-1
                      value: '1'
                    - descriptor:
                        code: pymnt-part-2
                      value: '2'
            - id: pymnt-part-1
              type: ON-ORDER
              status: PAID
              collected_by: BAP
              tags:
                - descriptor:
                    code: ADV-DEPOSIT
              params:
                amount: '2000.00'
                currency: INR
                transaction_id: payment-utr-1234
            - id: pymnt-part-2
              type: ON-FULFILLMENT
              status: NOT-PAID
              collected_by: BPP
              tags:
                - descriptor:
                    code: FINAL-PAYMENT
          tags:
            - code: bap_terms
              list:
                - code: static_terms
                  value: >-
                    https://github.com/ONDC-Official/NP-Static-Terms/buyerNP_BNP/1.0/tc.pdf
                - code: tax_number
                  value: gst_number_of_buyerNP
          created_at: '2026-02-23T18:01:42.263Z'
          updated_at: '2026-02-23T18:01:42.263Z'
    action: confirm
    saved_info: {}
  - action_id: on_confirm_1
    payload:
      context:
        domain: 'ONDC:RETINVL'
        action: on_confirm
        timestamp: '2026-02-23T18:01:42.298Z'
        transaction_id: 3d642d45-ec0a-4555-a115-da3a2145b66d
        message_id: 5c14aeda-67fc-4ed9-965c-9dd77e2a124a
        bap_id: bap.example.com
        bap_uri: 'https://bap.example.com'
        ttl: PT30S
        bpp_id: bpp.example.com
        bpp_uri: 'https://bpp.example.com'
        country: IND
        city: 'std:080'
        core_version: 1.2.5
      message:
        order:
          id: 95cea752-65f3-4c6a-833f-a77c55acb277
          type: ILBN
          state: Accepted
          provider:
            id: P1
            locations:
              - id: L1
          items:
            - id: I1
              fulfillment_id: F1
              quantity:
                count: 1
          billing:
            name: ONDC buyer
            address:
              name: My Address
              building: My Building
              locality: My Street
              city: Bengaluru
              state: Karnataka
              country: IND
              area_code: '560002'
            phone: '9886098860'
            email: buyer@test.com
            created_at: '2026-02-23T18:01:42.263Z'
            updated_at: '2026-02-23T18:01:42.263Z'
          fulfillments:
            - id: F1
              type: Delivery
              '@ondc/org/TAT': PT4H
              '@ondc/org/provider_name': LSP Express
              state:
                descriptor:
                  code: Pending
              tracking: true
              start:
                location:
                  descriptor:
                    name: ABC Store
                  gps: '12.9675,77.7496'
                  address:
                    locality: Jayanagar
                    city: Bengaluru
                    area_code: '560076'
                    state: KA
                contact:
                  phone: '9886098860'
                  email: nobody@nomail.com
              end:
                location:
                  gps: '12.4535,77.9283'
                  address:
                    name: My Address
                    building: My Building
                    locality: My Street
                    city: Bengaluru
                    state: Karnataka
                    country: IND
                    area_code: '560002'
                time:
                  range:
                    start: '2026-02-23T19:01:42.299Z'
                    end: '2026-02-23T19:31:42.299Z'
                person:
                  name: Customer
                contact:
                  phone: '9886098860'
                  email: buyer@test.com
              tags:
                - code: routing
                  list:
                    - code: type
                      value: P2P
                - code: tracking
                  list:
                    - code: gps_enabled
                      value: 'yes'
                    - code: url_enabled
                      value: 'no'
                    - code: url
                      value: 'https://snp.com/ondc/tracking_url'
          quote:
            breakup:
              - '@ondc/org/item_id': I1
                '@ondc/org/item_quantity':
                  count: 1
                title: Apple Mobile Phone Standard
                '@ondc/org/title_type': item
                price:
                  currency: INR
                  value: '10841.00'
                item:
                  price:
                    currency: INR
                    value: '10841'
              - '@ondc/org/item_id': F1
                title: Delivery charges
                '@ondc/org/title_type': delivery
                price:
                  currency: INR
                  value: '493.75'
              - '@ondc/org/item_id': F1
                title: Convenience Fee
                '@ondc/org/title_type': misc
                price:
                  currency: INR
                  value: '3.00'
            price:
              currency: INR
              value: '11337.75'
            ttl: P1D
          payments:
            - id: '3'
              type: PART-PAYMENT
              tags:
                - descriptor:
                    code: LINKED-PAYMENTS
                  list:
                    - descriptor:
                        code: pymnt-part-1
                      value: '1'
                    - descriptor:
                        code: pymnt-part-2
                      value: '2'
            - id: pymnt-part-1
              type: ON-ORDER
              status: PAID
              collected_by: BAP
              tags:
                - descriptor:
                    code: ADV-DEPOSIT
              params:
                amount: '2000.00'
                currency: INR
                transaction_id: payment-utr-1234
            - id: pymnt-part-2
              type: ON-FULFILLMENT
              status: NOT-PAID
              collected_by: BPP
              tags:
                - descriptor:
                    code: FINAL-PAYMENT
              params:
                amount: '9337.75'
                currency: INR
          tags:
            - code: bap_terms
              list:
                - code: static_terms
                  value: >-
                    https://github.com/ONDC-Official/NP-Static-Terms/buyerNP_BNP/1.0/tc.pdf
                - code: tax_number
                  value: gst_number_of_buyerNP
          created_at: '2026-02-23T18:01:42.263Z'
          updated_at: '2026-02-23T18:01:42.298Z'
    action: on_confirm
    saved_info: {}
validationLib: ''
helperLib: >-
  LyoKCUN1c3RvbSBoZWxwZXIgZnVuY3Rpb25zIGF2YWlsYWJsZSBpbiBhbGwgbW9jayBnZW5lcmF0aW9uIGZ1bmN0aW9ucy4KCXRoZXNlIGFyZSBhcHBlbmRlZCBiZWxvdyB0aGUgZ2VuZXJhdGUgZnVuY3Rpb24gZm9yIGVhY2ggc3RlcC4KKi8KCmNvbnN0IGNyZWF0ZUZvcm1VUkwgPSAoZG9tYWluLCBmb3JtSWQsIHNlc3Npb25EYXRhKSA9PiB7Cgljb25zdCBiYXNlVVJMID0gc2Vzc2lvbkRhdGEubW9ja0Jhc2VVcmw7Cgljb25zdCB0cmFuc2FjdGlvbklkID0gc2Vzc2lvbkRhdGEudHJhbnNhY3Rpb25JZFswXTsKCWNvbnN0IHNlc3Npb25JZCA9IHNlc3Npb25EYXRhLnNlc3Npb25JZDsKCXJldHVybiBgJHtiYXNlVVJMfS9mb3Jtcy8ke2RvbWFpbn0vJHtmb3JtSWR9Lz90cmFuc2FjdGlvbl9pZD0ke3RyYW5zYWN0aW9uSWR9JnNlc3Npb25faWQ9JHtzZXNzaW9uSWR9YDsKfQoKLy8gR2VuZXJhdGVzIGEgVVVJRCB2NApmdW5jdGlvbiB1dWlkdjQoKSB7CglyZXR1cm4gJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbiAoYykgewoJCWNvbnN0IHIgPSBNYXRoLnJhbmRvbSgpICogMTYgfCAwOwoJCWNvbnN0IHYgPSBjID09PSAneCcgPyByIDogKHIgJiAweDMgfCAweDgpOwoJCXJldHVybiB2LnRvU3RyaW5nKDE2KTsKCX0pOwp9CgovLyBHZW5lcmF0ZSBhIDYgZGlnaXQgc3RyaW5nIElECmZ1bmN0aW9uIGdlbmVyYXRlNkRpZ2l0SWQoKSB7CglyZXR1cm4gTWF0aC5mbG9vcigxMDAwMDAgKyBNYXRoLnJhbmRvbSgpICogOTAwMDAwKS50b1N0cmluZygpOwp9CgovLyBSZXR1cm5zIHRoZSBjdXJyZW50IElTTyB0aW1lc3RhbXAKZnVuY3Rpb24gY3VycmVudFRpbWVzdGFtcCgpIHsKCXJldHVybiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7Cn0KCi8vIENvbnZlcnRzIElTTyA4NjAxIGR1cmF0aW9uIHN0cmluZyB0byB0b3RhbCBzZWNvbmRzCmNvbnN0IGlzb0R1clRvU2VjID0gKGR1cmF0aW9uKSA9PiB7Cgljb25zdCBkdXJSRSA9IC9QKChkKylZKT8oKGQrKU0pPygoZCspVyk/KChkKylEKT9UPygoZCspSCk/KChkKylNKT8oKGQrKVMpPy87Cgljb25zdCBzID0gZHVyUkUuZXhlYyhkdXJhdGlvbik7CglpZiAoIXMpIHJldHVybiAwOwoKCXJldHVybiAoTnVtYmVyKHM/LlsyXSkgfHwgMCkgKiAzMTUzNjAwMCArCgkJKE51bWJlcihzPy5bNF0pIHx8IDApICogMjYyODI4OCArCgkJKE51bWJlcihzPy5bNl0pIHx8IDApICogNjA0ODAwICsKCQkoTnVtYmVyKHM/Lls4XSkgfHwgMCkgKiA4NjQwMCArCgkJKE51bWJlcihzPy5bMTBdKSB8fCAwKSAqIDM2MDAgKwoJCShOdW1iZXIocz8uWzEyXSkgfHwgMCkgKiA2MCArCgkJKE51bWJlcihzPy5bMTRdKSB8fCAwKTsKfTsKCmNvbnN0IHNldENpdHlGcm9tSW5wdXRzID0gKHBheWxvYWQsIGlucHV0cykgPT4gewoJaWYgKCFpbnB1dHMpIHJldHVybiAiKiI7CglsZXQgdmVyc2lvbiA9IHBheWxvYWQuY29udGV4dC52ZXJzaW9uIHx8IHBheWxvYWQuY29udGV4dC5jb3JlX3ZlcnNpb24gfHwgIjIuMC4wIjsKCWlmICh2ZXJzaW9uLnN0YXJ0c1dpdGgoIjEiKSkgewoJCXBheWxvYWQuY29udGV4dC5jaXR5ID0gaW5wdXRzLmNpdHlfY29kZSA/PyAiKiI7Cgl9IGVsc2UgewoJCXBheWxvYWQuY29udGV4dC5sb2NhdGlvbi5jaXR5LmNvZGUgPSBpbnB1dHMuY2l0eV9jb2RlID8/ICIqIjsKCX0KfQpjb25zdCBicmVha3VwSXRlbSA9IHsKCSJAb25kYy9vcmcvaXRlbV9pZCI6ICJJMSIsCgkiQG9uZGMvb3JnL2l0ZW1fcXVhbnRpdHkiOiB7CgkJY291bnQ6IDEsCgl9LAoJdGl0bGU6ICJJcGhvbmUiLAoJIkBvbmRjL29yZy90aXRsZV90eXBlIjogIml0ZW0iLAoJcHJpY2U6IHsKCQljdXJyZW5jeTogIklOUiIsCgkJdmFsdWU6ICIxMDg0MS4wMCIsCgl9LAoJaXRlbTogewoJCXByaWNlOiB7CgkJCWN1cnJlbmN5OiAiSU5SIiwKCQkJdmFsdWU6ICIxMDg0MS4wMCIsCgkJfSwKCX0sCn07Cgpjb25zdCBicmVha3VwID0gWwoJewoJCSJAb25kYy9vcmcvaXRlbV9pZCI6ICJGMSIsCgkJdGl0bGU6ICJEZWxpdmVyeSBjaGFyZ2VzIiwKCQkiQG9uZGMvb3JnL3RpdGxlX3R5cGUiOiAiZGVsaXZlcnkiLAoJCXByaWNlOiB7CgkJCWN1cnJlbmN5OiAiSU5SIiwKCQkJdmFsdWU6ICI0OTMuNzUiLAoJCX0sCgl9LAoJewoJCSJAb25kYy9vcmcvaXRlbV9pZCI6ICJGMSIsCgkJdGl0bGU6ICJDb252ZW5pZW5jZSBGZWUiLAoJCSJAb25kYy9vcmcvdGl0bGVfdHlwZSI6ICJtaXNjIiwKCQlwcmljZTogewoJCQljdXJyZW5jeTogIklOUiIsCgkJCXZhbHVlOiAiMy4wMCIsCgkJfSwKCX0sCl07CmZ1bmN0aW9uIGNyZWF0ZVF1b3RlKAoJc2VsZWN0ZWRJdGVtcywKCXNlc3Npb25EYXRhLAoJZXhpc3RpbmdQYXlsb2FkLAoJZnVsZmlsbG1lbnRzLAoJY2FuY2VsbGVkID0gZmFsc2UKKSB7Cgljb25zb2xlLmxvZygiXG4gIyMgQ3JlYXRpbmcgUXVvdGUgd2l0aCBzZWxlY3RlZCBpdGVtczogXG4iLCBzZWxlY3RlZEl0ZW1zKTsKCglsZXQgdG90YWxQcmljZSA9IDA7CglsZXQgdG90YWxRdWFudGl0eSA9IDA7Cgljb25zdCBpdGVtU2V0ID0gbmV3IFNldCgpOwoJY29uc3QgYnJlYWt1cE9iamVjdCA9IFtdOwoKCWNvbnN0IGNhdGFsb2dJdGVtcyA9CgkJUkVUSU5WTDEyNUNhdGFsb2cuY2F0YWxvZ1siYnBwL3Byb3ZpZGVycyJdWzBdLml0ZW1zLmZpbHRlcigKCQkJKGkpID0+IHsKCQkJCWNvbnNvbGUubG9nKCJDYXRhbG9nIEl0ZW06ICIsIGkuaWQpOwoJCQkJY29uc3QgaWRNYXAgPSBzZWxlY3RlZEl0ZW1zLm1hcCgoaXRlbSkgPT4gaXRlbS5pZCk7CgkJCQljb25zb2xlLmxvZygiSUQgTWFwOiAiLCBpZE1hcCk7CgkJCQlyZXR1cm4gaWRNYXAuaW5jbHVkZXMoaS5pZCk7CgkJCX0KCQkpOwoKCWZvciAoY29uc3Qgc2VsZWN0ZWRJdGVtIG9mIHNlbGVjdGVkSXRlbXMgfHwgW10pIHsKCQljb25zdCBmdWxmaWxsbWVudCA9IGZ1bGZpbGxtZW50cy5maW5kKAoJCQkoZikgPT4gZi5pZCA9PT0gc2VsZWN0ZWRJdGVtLmZ1bGZpbGxtZW50X2lkCgkJKTsKCgkJaWYgKAoJCQkhZnVsZmlsbG1lbnQgfHwKCQkJIVsiRGVsaXZlcnkiLCAiU2VsZi1QaWNrdXAiLCAiQnV5ZXItRGVsaXZlcnkiXS5pbmNsdWRlcygKCQkJCWZ1bGZpbGxtZW50LnR5cGUgfHwgIiIKCQkJKQoJCSkgewoJCQljb250aW51ZTsKCQl9CgoJCWNvbnN0IGNhdGFsb2dJdGVtID0gY2F0YWxvZ0l0ZW1zLmZpbmQoCgkJCShpKSA9PiBpLmlkID09PSBzZWxlY3RlZEl0ZW0uaWQKCQkpOwoKCQlpZiAoIWNhdGFsb2dJdGVtKSBjb250aW51ZTsKCgkJY29uc3QgcXVhbnRpdHkgPSBjYW5jZWxsZWQgPyAwIDogc2VsZWN0ZWRJdGVtLmNvdW50IHx8IDE7CgkJY29uc3QgcHJpY2UgPSBwYXJzZUZsb2F0KGNhdGFsb2dJdGVtLnByaWNlLnZhbHVlKSAqIHF1YW50aXR5OwoKCQljb25zb2xlLmxvZygiUHJpY2U6ICIsIHByaWNlLCBjYXRhbG9nSXRlbS5wcmljZS52YWx1ZSk7CgoJCXRvdGFsUHJpY2UgKz0gcHJpY2U7CgoJCWNvbnN0IGJyZWFrdXBDbG9uZSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYnJlYWt1cEl0ZW0pKTsKCgkJYnJlYWt1cENsb25lWyJAb25kYy9vcmcvaXRlbV9pZCJdID0gY2F0YWxvZ0l0ZW0uaWQ7CgkJYnJlYWt1cENsb25lLnRpdGxlID0gY2F0YWxvZ0l0ZW0uZGVzY3JpcHRvci5uYW1lOwoJCWJyZWFrdXBDbG9uZVsiQG9uZGMvb3JnL2l0ZW1fcXVhbnRpdHkiXS5jb3VudCA9IHF1YW50aXR5OwoJCWJyZWFrdXBDbG9uZS5wcmljZS52YWx1ZSA9IHByaWNlLnRvRml4ZWQoMik7CgoJCWlmIChzZWxlY3RlZEl0ZW0udGFncykgewoJCQlpZiAoc2VsZWN0ZWRJdGVtLnBhcmVudF9pdGVtX2lkKSB7CgkJCQlicmVha3VwQ2xvbmUucGFyZW50X2l0ZW1faWQgPSBzZWxlY3RlZEl0ZW0ucGFyZW50X2l0ZW1faWQ7CgkJCX0KCQkJYnJlYWt1cENsb25lLnRhZ3MgPSBzZWxlY3RlZEl0ZW0udGFnczsKCQl9CgoJCWJyZWFrdXBDbG9uZS5pdGVtLnByaWNlLnZhbHVlID0gY2F0YWxvZ0l0ZW0ucHJpY2UudmFsdWU7CgoJCWJyZWFrdXBPYmplY3QucHVzaChicmVha3VwQ2xvbmUpOwoKCQlpZiAoCgkJCXNlc3Npb25EYXRhLm91dF9vZl9zdG9ja19pdGVtX2lkcyAmJgoJCQlzZXNzaW9uRGF0YS5vdXRfb2Zfc3RvY2tfaXRlbV9pZHMuaW5jbHVkZXMoY2F0YWxvZ0l0ZW0uaWQpCgkJKSB7CgkJCWJyZWFrdXBDbG9uZS5pdGVtLnF1YW50aXR5LmF2YWlsYWJsZS5jb3VudCA9ICIwIjsKCQkJYnJlYWt1cENsb25lLml0ZW0ucXVhbnRpdHkubWF4aW11bS5jb3VudCA9ICIwIjsKCQkJYnJlYWt1cENsb25lWyJAb25kYy9vcmcvdGl0bGVfdHlwZSJdID0gIml0ZW0iOwoKCQkJZXhpc3RpbmdQYXlsb2FkLmVycm9yID0gewoJCQkJdHlwZTogIkRPTUFJTi1FUlJPUiIsCgkJCQljb2RlOiAiNDAwMDIiLAoJCQkJbWVzc2FnZTogYEl0ZW0gd2l0aCBpZDogJHtjYXRhbG9nSXRlbS5pZH0gaXMgb3V0IG9mIHN0b2NrYCwKCQkJfTsKCQl9IGVsc2UgewoJCQl0b3RhbFF1YW50aXR5ICs9IHNlbGVjdGVkSXRlbS5jb3VudCB8fCAwOwoJCQlpZiAocXVhbnRpdHkgPiAwKSBpdGVtU2V0LmFkZChjYXRhbG9nSXRlbS5pZCk7CgkJfQoJfQoKCS8vIEFkZCBhZGRpdGlvbmFsIGJyZWFrdXAgY29tcG9uZW50cyAobGlrZSBkZWxpdmVyeSAmIHRheCkKCWJyZWFrdXBPYmplY3QucHVzaChicmVha3VwWzBdKTsKCWJyZWFrdXBPYmplY3QucHVzaChicmVha3VwWzFdKTsKCgl0b3RhbFByaWNlICs9IHBhcnNlRmxvYXQoYnJlYWt1cFswXS5wcmljZS52YWx1ZSk7Cgl0b3RhbFByaWNlICs9IHBhcnNlRmxvYXQoYnJlYWt1cFsxXS5wcmljZS52YWx1ZSk7CgoJY29uc29sZS5sb2coYFRvdGFsIFByaWNlOiAke3RvdGFsUHJpY2UudG9GaXhlZCgyKX1gKTsKCWNvbnNvbGUubG9nKGBUb3RhbCBRdWFudGl0eTogJHtKU09OLnN0cmluZ2lmeShicmVha3VwT2JqZWN0KX1gKTsKCglyZXR1cm4gewoJCWJyZWFrdXA6IGJyZWFrdXBPYmplY3QsCgkJcHJpY2U6IHsKCQkJY3VycmVuY3k6ICJJTlIiLAoJCQl2YWx1ZTogdG90YWxQcmljZS50b0ZpeGVkKDIpLAoJCX0sCgkJdHRsOiAiUDFEIiwKCX07Cn0KY29uc3QgUkVUSU5WTDEyNUNhdGFsb2cgPSB7CgkiY2F0YWxvZyI6IHsKCQkiYnBwL2Rlc2NyaXB0b3IiOiB7CgkJCSJuYW1lIjogIlNlbGxlciBOUCIsCgkJCSJzeW1ib2wiOiAiaHR0cHM6Ly9zbnAuY29tL2ltYWdlcy9ucC5wbmciLAoJCQkic2hvcnRfZGVzYyI6ICJTZWxsZXIgTWFya2V0cGxhY2UiLAoJCQkibG9uZ19kZXNjIjogIlNlbGxlciBNYXJrZXRwbGFjZSIsCgkJCSJpbWFnZXMiOiBbCgkJCQkiaHR0cHM6Ly9zbnAuY29tL2ltYWdlcy9ucC5wbmciCgkJCV0sCgkJCSJ0YWdzIjogWwoJCQkJewoJCQkJCSJjb2RlIjogImJwcF90ZXJtcyIsCgkJCQkJImxpc3QiOiBbCgkJCQkJCXsKCQkJCQkJCSJjb2RlIjogIm5wX3R5cGUiLAoJCQkJCQkJInZhbHVlIjogIk1TTiIKCQkJCQkJfSwKCQkJCQkJewoJCQkJCQkJImNvZGUiOiAiYWNjZXB0X2JhcF90ZXJtcyIsCgkJCQkJCQkidmFsdWUiOiAiWSIKCQkJCQkJfQoJCQkJCV0KCQkJCX0KCQkJXQoJCX0sCgkJImJwcC9wcm92aWRlcnMiOiBbCgkJCXsKCQkJCSJpZCI6ICJQMSIsCgkJCQkidGltZSI6IHsKCQkJCQkibGFiZWwiOiAiZW5hYmxlIiwKCQkJCQkidGltZXN0YW1wIjogIjIwMjYtMDItMjNUMDY6MDE6MTIuMTI1WiIKCQkJCX0sCgkJCQkiZnVsZmlsbG1lbnRzIjogWwoJCQkJCXsKCQkJCQkJImlkIjogIkYxIiwKCQkJCQkJInR5cGUiOiAiRGVsaXZlcnkiCgkJCQkJfSwKCQkJCQl7CgkJCQkJCSJpZCI6ICJGMiIsCgkJCQkJCSJ0eXBlIjogIlNlbGYtUGlja3VwIgoJCQkJCX0KCQkJCV0sCgkJCQkicGF5bWVudHMiOiBbCgkJCQkJewoJCQkJCQkiaWQiOiAiMSIsCgkJCQkJCSJ0eXBlIjogIk9OLU9SREVSIgoJCQkJCX0sCgkJCQkJewoJCQkJCQkiaWQiOiAiMiIsCgkJCQkJCSJ0eXBlIjogIk9OLUZVTEZJTExNRU5UIgoJCQkJCX0sCgkJCQkJewoJCQkJCQkiaWQiOiAiMyIsCgkJCQkJCSJ0eXBlIjogIlBBUlQtUEFZTUVOVCIsCgkJCQkJCSJ0YWdzIjogWwoJCQkJCQkJewoJCQkJCQkJCSJjb2RlIjogInBheW1lbnRfZGV0YWlsIiwKCQkJCQkJCQkibGlzdCI6IFsKCQkJCQkJCQkJewoJCQkJCQkJCQkJImNvZGUiOiAiQUxMT1dFRC1GVUxGSUxMTUVOVFMiLAoJCQkJCQkJCQkJInZhbHVlIjogIkYxLEYyIgoJCQkJCQkJCQl9CgkJCQkJCQkJXQoJCQkJCQkJfQoJCQkJCQldCgkJCQkJfSwKCQkJCQl7CgkJCQkJCSJpZCI6ICI0IiwKCQkJCQkJInR5cGUiOiAiUEFSVC1QQVlNRU5UIiwKCQkJCQkJInRhZ3MiOiBbCgkJCQkJCQl7CgkJCQkJCQkJImNvZGUiOiAicGF5bWVudF9kZXRhaWwiLAoJCQkJCQkJCSJsaXN0IjogWwoJCQkJCQkJCQl7CgkJCQkJCQkJCQkiY29kZSI6ICJBTExPV0VELUZVTEZJTExNRU5UUyIsCgkJCQkJCQkJCQkidmFsdWUiOiAiRjIiCgkJCQkJCQkJCX0KCQkJCQkJCQldCgkJCQkJCQl9CgkJCQkJCV0KCQkJCQl9CgkJCQldLAoJCQkJImRlc2NyaXB0b3IiOiB7CgkJCQkJIm5hbWUiOiAiU3RvcmUgMSIKCQkJCX0sCgkJCQkidHRsIjogIlAxRCIsCgkJCQkibG9jYXRpb25zIjogWwoJCQkJCXsKCQkJCQkJImlkIjogIkwxIiwKCQkJCQkJInRpbWUiOiB7CgkJCQkJCQkibGFiZWwiOiAiZW5hYmxlIiwKCQkJCQkJCSJ0aW1lc3RhbXAiOiAiMjAyNS0wMS0wOFQwNzozMDozMC4wMDBaIiwKCQkJCQkJCSJzY2hlZHVsZSI6IHsKCQkJCQkJCQkiaG9saWRheXMiOiBbCgkJCQkJCQkJCSIyMDI1LTAxLTI2IiwKCQkJCQkJCQkJIjIwMjUtMDgtMTUiCgkJCQkJCQkJXQoJCQkJCQkJfQoJCQkJCQl9LAoJCQkJCQkiZ3BzIjogIjEyLjk2NzUsNzcuNzQ5NiIsCgkJCQkJCSJhZGRyZXNzIjogewoJCQkJCQkJImFyZWFfY29kZSI6ICI1NjAwNzYiLAoJCQkJCQkJInN0YXRlIjogIktBIgoJCQkJCQl9CgkJCQkJfQoJCQkJXSwKCQkJCSJjYXRlZ29yaWVzIjogWwoJCQkJCXsKCQkJCQkJImlkIjogIlYxIiwKCQkJCQkJImRlc2NyaXB0b3IiOiB7CgkJCQkJCQkibmFtZSI6ICJWYXJpYW50IEdyb3VwIgoJCQkJCQl9LAoJCQkJCQkidGFncyI6IFsKCQkJCQkJCXsKCQkJCQkJCQkiY29kZSI6ICJ0eXBlIiwKCQkJCQkJCQkibGlzdCI6IFsKCQkJCQkJCQkJewoJCQkJCQkJCQkJImNvZGUiOiAidHlwZSIsCgkJCQkJCQkJCQkidmFsdWUiOiAidmFyaWFudF9ncm91cCIKCQkJCQkJCQkJfQoJCQkJCQkJCV0KCQkJCQkJCX0KCQkJCQkJXQoJCQkJCX0KCQkJCV0sCgkJCQkiaXRlbXMiOiBbCgkJCQkJewoJCQkJCQkiaWQiOiAiSTEiLAoJCQkJCQkidGltZSI6IHsKCQkJCQkJCSJsYWJlbCI6ICJlbmFibGUiLAoJCQkJCQkJInRpbWVzdGFtcCI6ICIyMDI2LTAyLTIzVDA2OjAxOjEyLjEyNVoiCgkJCQkJCX0sCgkJCQkJCSJwYXJlbnRfaXRlbV9pZCI6ICJWMSIsCgkJCQkJCSJkZXNjcmlwdG9yIjogewoJCQkJCQkJIm5hbWUiOiAiQXBwbGUgTW9iaWxlIFBob25lIFN0YW5kYXJkIiwKCQkJCQkJCSJjb2RlIjogIjM6R1RJTjEiLAoJCQkJCQkJInNob3J0X2Rlc2MiOiAiQXBwbGUgTW9iaWxlIFBob25lIFN0YW5kYXJkIiwKCQkJCQkJCSJsb25nX2Rlc2MiOiAiQXBwbGUgTW9iaWxlIFBob25lIFN0YW5kYXJkIEVkaXRpb24iLAoJCQkJCQkJImltYWdlcyI6IFsKCQkJCQkJCQkiaHR0cHM6Ly9kdW1teWltYWdlLmNvbS82MDB4NDAwLzAwMC9mZmYmdGV4dD1BcHBsZSUyME1vYmlsZSUyMFBob25lJTIwU3RhbmRhcmQiCgkJCQkJCQldCgkJCQkJCX0sCgkJCQkJCSJxdWFudGl0eSI6IHsKCQkJCQkJCSJ1bml0aXplZCI6IHsKCQkJCQkJCQkibWVhc3VyZSI6IHsKCQkJCQkJCQkJInVuaXQiOiAidW5pdCIsCgkJCQkJCQkJCSJ2YWx1ZSI6ICIxIgoJCQkJCQkJCX0KCQkJCQkJCX0sCgkJCQkJCQkibWF4aW11bSI6IHsKCQkJCQkJCQkiY291bnQiOiAiNSIKCQkJCQkJCX0KCQkJCQkJfSwKCQkJCQkJInByaWNlIjogewoJCQkJCQkJImN1cnJlbmN5IjogIklOUiIsCgkJCQkJCQkidmFsdWUiOiAiMTA4NDEiLAoJCQkJCQkJIm1heGltdW1fdmFsdWUiOiAiMTI4NDEiCgkJCQkJCX0sCgkJCQkJCSJjYXRlZ29yeV9pZCI6ICJNb2JpbGUgUGhvbmUiLAoJCQkJCQkiZnVsZmlsbG1lbnRfaWQiOiAiRjEiLAoJCQkJCQkicGF5bWVudF9pZHMiOiBbCgkJCQkJCQkiMSIKCQkJCQkJXSwKCQkJCQkJImxvY2F0aW9uX2lkIjogIkwxIgoJCQkJCX0sCgkJCQkJewoJCQkJCQkiaWQiOiAiSTIiLAoJCQkJCQkidGltZSI6IHsKCQkJCQkJCSJsYWJlbCI6ICJlbmFibGUiLAoJCQkJCQkJInRpbWVzdGFtcCI6ICIyMDI2LTAyLTIzVDA2OjAxOjEyLjEyNVoiCgkJCQkJCX0sCgkJCQkJCSJwYXJlbnRfaXRlbV9pZCI6ICJWMSIsCgkJCQkJCSJkZXNjcmlwdG9yIjogewoJCQkJCQkJIm5hbWUiOiAiQXBwbGUgTW9iaWxlIFBob25lIFBybyIsCgkJCQkJCQkiY29kZSI6ICIzOkdUSU4yIiwKCQkJCQkJCSJzaG9ydF9kZXNjIjogIkFwcGxlIE1vYmlsZSBQaG9uZSBQcm8iLAoJCQkJCQkJImxvbmdfZGVzYyI6ICJBcHBsZSBNb2JpbGUgUGhvbmUgUHJvIEVkaXRpb24iLAoJCQkJCQkJImltYWdlcyI6IFsKCQkJCQkJCQkiaHR0cHM6Ly9kdW1teWltYWdlLmNvbS82MDB4NDAwLzAwMC9mZmYmdGV4dD1BcHBsZSUyME1vYmlsZSUyMFBob25lJTIwUHJvIgoJCQkJCQkJXQoJCQkJCQl9LAoJCQkJCQkicXVhbnRpdHkiOiB7CgkJCQkJCQkidW5pdGl6ZWQiOiB7CgkJCQkJCQkJIm1lYXN1cmUiOiB7CgkJCQkJCQkJCSJ1bml0IjogInVuaXQiLAoJCQkJCQkJCQkidmFsdWUiOiAiMSIKCQkJCQkJCQl9CgkJCQkJCQl9LAoJCQkJCQkJIm1heGltdW0iOiB7CgkJCQkJCQkJImNvdW50IjogIjUiCgkJCQkJCQl9CgkJCQkJCX0sCgkJCQkJCSJwcmljZSI6IHsKCQkJCQkJCSJjdXJyZW5jeSI6ICJJTlIiLAoJCQkJCQkJInZhbHVlIjogIjIyMjQxIiwKCQkJCQkJCSJtYXhpbXVtX3ZhbHVlIjogIjI0MjQxIgoJCQkJCQl9LAoJCQkJCQkiY2F0ZWdvcnlfaWQiOiAiTW9iaWxlIFBob25lIiwKCQkJCQkJImZ1bGZpbGxtZW50X2lkIjogIkYxIiwKCQkJCQkJInBheW1lbnRfaWRzIjogWwoJCQkJCQkJIjEiCgkJCQkJCV0sCgkJCQkJCSJsb2NhdGlvbl9pZCI6ICJMMSIKCQkJCQl9LAoJCQkJCXsKCQkJCQkJImlkIjogIkkzIiwKCQkJCQkJInRpbWUiOiB7CgkJCQkJCQkibGFiZWwiOiAiZW5hYmxlIiwKCQkJCQkJCSJ0aW1lc3RhbXAiOiAiMjAyNi0wMi0yM1QwNjowMToxMi4xMjVaIgoJCQkJCQl9LAoJCQkJCQkicGFyZW50X2l0ZW1faWQiOiAiVjEiLAoJCQkJCQkiZGVzY3JpcHRvciI6IHsKCQkJCQkJCSJuYW1lIjogIkFwcGxlIE1vYmlsZSBQaG9uZSBQcmVtaXVtIiwKCQkJCQkJCSJjb2RlIjogIjM6R1RJTjMiLAoJCQkJCQkJInNob3J0X2Rlc2MiOiAiQXBwbGUgTW9iaWxlIFBob25lIFByZW1pdW0iLAoJCQkJCQkJImxvbmdfZGVzYyI6ICJBcHBsZSBNb2JpbGUgUGhvbmUgUHJlbWl1bSBFZGl0aW9uIiwKCQkJCQkJCSJpbWFnZXMiOiBbCgkJCQkJCQkJImh0dHBzOi8vZHVtbXlpbWFnZS5jb20vNjAweDQwMC8wMDAvZmZmJnRleHQ9QXBwbGUlMjBNb2JpbGUlMjBQaG9uZSUyMFByZW1pdW0iCgkJCQkJCQldCgkJCQkJCX0sCgkJCQkJCSJxdWFudGl0eSI6IHsKCQkJCQkJCSJ1bml0aXplZCI6IHsKCQkJCQkJCQkibWVhc3VyZSI6IHsKCQkJCQkJCQkJInVuaXQiOiAidW5pdCIsCgkJCQkJCQkJCSJ2YWx1ZSI6ICIxIgoJCQkJCQkJCX0KCQkJCQkJCX0sCgkJCQkJCQkibWF4aW11bSI6IHsKCQkJCQkJCQkiY291bnQiOiAiNSIKCQkJCQkJCX0KCQkJCQkJfSwKCQkJCQkJInByaWNlIjogewoJCQkJCQkJImN1cnJlbmN5IjogIklOUiIsCgkJCQkJCQkidmFsdWUiOiAiMzg4MyIsCgkJCQkJCQkibWF4aW11bV92YWx1ZSI6ICI1ODgzIgoJCQkJCQl9LAoJCQkJCQkiY2F0ZWdvcnlfaWQiOiAiTW9iaWxlIFBob25lIiwKCQkJCQkJImZ1bGZpbGxtZW50X2lkIjogIkYxIiwKCQkJCQkJInBheW1lbnRfaWRzIjogWwoJCQkJCQkJIjEiCgkJCQkJCV0sCgkJCQkJCSJsb2NhdGlvbl9pZCI6ICJMMSIKCQkJCQl9LAoJCQkJCXsKCQkJCQkJImlkIjogIkk0IiwKCQkJCQkJInRpbWUiOiB7CgkJCQkJCQkibGFiZWwiOiAiZW5hYmxlIiwKCQkJCQkJCSJ0aW1lc3RhbXAiOiAiMjAyNi0wMi0yM1QwNjowMToxMi4xMjVaIgoJCQkJCQl9LAoJCQkJCQkicGFyZW50X2l0ZW1faWQiOiAiVjEiLAoJCQkJCQkiZGVzY3JpcHRvciI6IHsKCQkJCQkJCSJuYW1lIjogIlNhbXN1bmcgTW9iaWxlIFBob25lIFN0YW5kYXJkIiwKCQkJCQkJCSJjb2RlIjogIjM6R1RJTjQiLAoJCQkJCQkJInNob3J0X2Rlc2MiOiAiU2Ftc3VuZyBNb2JpbGUgUGhvbmUgU3RhbmRhcmQiLAoJCQkJCQkJImxvbmdfZGVzYyI6ICJTYW1zdW5nIE1vYmlsZSBQaG9uZSBTdGFuZGFyZCBFZGl0aW9uIiwKCQkJCQkJCSJpbWFnZXMiOiBbCgkJCQkJCQkJImh0dHBzOi8vZHVtbXlpbWFnZS5jb20vNjAweDQwMC8wMDAvZmZmJnRleHQ9U2Ftc3VuZyUyME1vYmlsZSUyMFBob25lJTIwU3RhbmRhcmQiCgkJCQkJCQldCgkJCQkJCX0sCgkJCQkJCSJxdWFudGl0eSI6IHsKCQkJCQkJCSJ1bml0aXplZCI6IHsKCQkJCQkJCQkibWVhc3VyZSI6IHsKCQkJCQkJCQkJInVuaXQiOiAidW5pdCIsCgkJCQkJCQkJCSJ2YWx1ZSI6ICIxIgoJCQkJCQkJCX0KCQkJCQkJCX0sCgkJCQkJCQkibWF4aW11bSI6IHsKCQkJCQkJCQkiY291bnQiOiAiNSIKCQkJCQkJCX0KCQkJCQkJfSwKCQkJCQkJInByaWNlIjogewoJCQkJCQkJImN1cnJlbmN5IjogIklOUiIsCgkJCQkJCQkidmFsdWUiOiAiNzMxNyIsCgkJCQkJCQkibWF4aW11bV92YWx1ZSI6ICI5MzE3IgoJCQkJCQl9LAoJCQkJCQkiY2F0ZWdvcnlfaWQiOiAiTW9iaWxlIFBob25lIiwKCQkJCQkJImZ1bGZpbGxtZW50X2lkIjogIkYxIiwKCQkJCQkJInBheW1lbnRfaWRzIjogWwoJCQkJCQkJIjEiCgkJCQkJCV0sCgkJCQkJCSJsb2NhdGlvbl9pZCI6ICJMMSIKCQkJCQl9LAoJCQkJCXsKCQkJCQkJImlkIjogIkk1IiwKCQkJCQkJInRpbWUiOiB7CgkJCQkJCQkibGFiZWwiOiAiZW5hYmxlIiwKCQkJCQkJCSJ0aW1lc3RhbXAiOiAiMjAyNi0wMi0yM1QwNjowMToxMi4xMjVaIgoJCQkJCQl9LAoJCQkJCQkicGFyZW50X2l0ZW1faWQiOiAiVjEiLAoJCQkJCQkiZGVzY3JpcHRvciI6IHsKCQkJCQkJCSJuYW1lIjogIlNhbXN1bmcgTW9iaWxlIFBob25lIFBybyIsCgkJCQkJCQkiY29kZSI6ICIzOkdUSU41IiwKCQkJCQkJCSJzaG9ydF9kZXNjIjogIlNhbXN1bmcgTW9iaWxlIFBob25lIFBybyIsCgkJCQkJCQkibG9uZ19kZXNjIjogIlNhbXN1bmcgTW9iaWxlIFBob25lIFBybyBFZGl0aW9uIiwKCQkJCQkJCSJpbWFnZXMiOiBbCgkJCQkJCQkJImh0dHBzOi8vZHVtbXlpbWFnZS5jb20vNjAweDQwMC8wMDAvZmZmJnRleHQ9U2Ftc3VuZyUyME1vYmlsZSUyMFBob25lJTIwUHJvIgoJCQkJCQkJXQoJCQkJCQl9LAoJCQkJCQkicXVhbnRpdHkiOiB7CgkJCQkJCQkidW5pdGl6ZWQiOiB7CgkJCQkJCQkJIm1lYXN1cmUiOiB7CgkJCQkJCQkJCSJ1bml0IjogInVuaXQiLAoJCQkJCQkJCQkidmFsdWUiOiAiMSIKCQkJCQkJCQl9CgkJCQkJCQl9LAoJCQkJCQkJIm1heGltdW0iOiB7CgkJCQkJCQkJImNvdW50IjogIjUiCgkJCQkJCQl9CgkJCQkJCX0sCgkJCQkJCSJwcmljZSI6IHsKCQkJCQkJCSJjdXJyZW5jeSI6ICJJTlIiLAoJCQkJCQkJInZhbHVlIjogIjE2ODYyIiwKCQkJCQkJCSJtYXhpbXVtX3ZhbHVlIjogIjE4ODYyIgoJCQkJCQl9LAoJCQkJCQkiY2F0ZWdvcnlfaWQiOiAiTW9iaWxlIFBob25lIiwKCQkJCQkJImZ1bGZpbGxtZW50X2lkIjogIkYxIiwKCQkJCQkJInBheW1lbnRfaWRzIjogWwoJCQkJCQkJIjEiCgkJCQkJCV0sCgkJCQkJCSJsb2NhdGlvbl9pZCI6ICJMMSIKCQkJCQl9LAoJCQkJCXsKCQkJCQkJImlkIjogIkk2IiwKCQkJCQkJInRpbWUiOiB7CgkJCQkJCQkibGFiZWwiOiAiZW5hYmxlIiwKCQkJCQkJCSJ0aW1lc3RhbXAiOiAiMjAyNi0wMi0yM1QwNjowMToxMi4xMjVaIgoJCQkJCQl9LAoJCQkJCQkicGFyZW50X2l0ZW1faWQiOiAiVjEiLAoJCQkJCQkiZGVzY3JpcHRvciI6IHsKCQkJCQkJCSJuYW1lIjogIlNhbXN1bmcgTW9iaWxlIFBob25lIFByZW1pdW0iLAoJCQkJCQkJImNvZGUiOiAiMzpHVElONiIsCgkJCQkJCQkic2hvcnRfZGVzYyI6ICJTYW1zdW5nIE1vYmlsZSBQaG9uZSBQcmVtaXVtIiwKCQkJCQkJCSJsb25nX2Rlc2MiOiAiU2Ftc3VuZyBNb2JpbGUgUGhvbmUgUHJlbWl1bSBFZGl0aW9uIiwKCQkJCQkJCSJpbWFnZXMiOiBbCgkJCQkJCQkJImh0dHBzOi8vZHVtbXlpbWFnZS5jb20vNjAweDQwMC8wMDAvZmZmJnRleHQ9U2Ftc3VuZyUyME1vYmlsZSUyMFBob25lJTIwUHJlbWl1bSIKCQkJCQkJCV0KCQkJCQkJfSwKCQkJCQkJInF1YW50aXR5IjogewoJCQkJCQkJInVuaXRpemVkIjogewoJCQkJCQkJCSJtZWFzdXJlIjogewoJCQkJCQkJCQkidW5pdCI6ICJ1bml0IiwKCQkJCQkJCQkJInZhbHVlIjogIjEiCgkJCQkJCQkJfQoJCQkJCQkJfSwKCQkJCQkJCSJtYXhpbXVtIjogewoJCQkJCQkJCSJjb3VudCI6ICI1IgoJCQkJCQkJfQoJCQkJCQl9LAoJCQkJCQkicHJpY2UiOiB7CgkJCQkJCQkiY3VycmVuY3kiOiAiSU5SIiwKCQkJCQkJCSJ2YWx1ZSI6ICIxNzUyOSIsCgkJCQkJCQkibWF4aW11bV92YWx1ZSI6ICIxOTUyOSIKCQkJCQkJfSwKCQkJCQkJImNhdGVnb3J5X2lkIjogIk1vYmlsZSBQaG9uZSIsCgkJCQkJCSJmdWxmaWxsbWVudF9pZCI6ICJGMSIsCgkJCQkJCSJwYXltZW50X2lkcyI6IFsKCQkJCQkJCSIxIgoJCQkJCQldLAoJCQkJCQkibG9jYXRpb25faWQiOiAiTDEiCgkJCQkJfQoJCQkJXSwKCQkJCSJ0YWdzIjogWwoJCQkJCXsKCQkJCQkJImNvZGUiOiAidGltaW5nIiwKCQkJCQkJImxpc3QiOiBbCgkJCQkJCQl7CgkJCQkJCQkJImNvZGUiOiAidHlwZSIsCgkJCQkJCQkJInZhbHVlIjogIkFsbCIKCQkJCQkJCX0sCgkJCQkJCQl7CgkJCQkJCQkJImNvZGUiOiAibG9jYXRpb24iLAoJCQkJCQkJCSJ2YWx1ZSI6ICJMMSIKCQkJCQkJCX0sCgkJCQkJCQl7CgkJCQkJCQkJImNvZGUiOiAiZGF5X2Zyb20iLAoJCQkJCQkJCSJ2YWx1ZSI6ICIxIgoJCQkJCQkJfSwKCQkJCQkJCXsKCQkJCQkJCQkiY29kZSI6ICJkYXlfdG8iLAoJCQkJCQkJCSJ2YWx1ZSI6ICI3IgoJCQkJCQkJfSwKCQkJCQkJCXsKCQkJCQkJCQkiY29kZSI6ICJ0aW1lX2Zyb20iLAoJCQkJCQkJCSJ2YWx1ZSI6ICIwMDAwIgoJCQkJCQkJfSwKCQkJCQkJCXsKCQkJCQkJCQkiY29kZSI6ICJ0aW1lX3RvIiwKCQkJCQkJCQkidmFsdWUiOiAiMjM1OSIKCQkJCQkJCX0KCQkJCQkJXQoJCQkJCX0sCgkJCQkJewoJCQkJCQkiY29kZSI6ICJzZXJ2aWNlYWJpbGl0eSIsCgkJCQkJCSJsaXN0IjogWwoJCQkJCQkJewoJCQkJCQkJCSJjb2RlIjogImxvY2F0aW9uIiwKCQkJCQkJCQkidmFsdWUiOiAiTDEiCgkJCQkJCQl9LAoJCQkJCQkJewoJCQkJCQkJCSJjb2RlIjogImNhdGVnb3J5IiwKCQkJCQkJCQkidmFsdWUiOiAiTW9iaWxlIFBob25lIgoJCQkJCQkJfSwKCQkJCQkJCXsKCQkJCQkJCQkiY29kZSI6ICJ0eXBlIiwKCQkJCQkJCQkidmFsdWUiOiAiMTMiCgkJCQkJCQl9LAoJCQkJCQkJewoJCQkJCQkJCSJjb2RlIjogInVuaXQiLAoJCQkJCQkJCSJ2YWx1ZSI6ICJnZW9qc29uIgoJCQkJCQkJfSwKCQkJCQkJCXsKCQkJCQkJCQkiY29kZSI6ICJ2YWwiLAoJCQkJCQkJCSJ2YWx1ZSI6ICJ7XCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIiwgXCJmZWF0dXJlc1wiOiBbe1widHlwZVwiOiBcIkZlYXR1cmVcIiwgXCJwcm9wZXJ0aWVzXCI6IHt9LCBcImdlb21ldHJ5XCI6IHtcImNvb3JkaW5hdGVzXCI6IFtbW1s3Ny40MzY2LCAxNC42MjMwXSwgWzc1LjU5NzMsIDEzLjI1MDddLCBbNzYuODM1OSwgMTEuOTMyOV0sIFs3OC43NzA5LCAxMS4zMjkwXV1dLCBbW1s3NS42OTQ4LCAxNS45OTI4XSwgWzc0LjgzMTksIDE0Ljg1MTVdLCBbNzcuNDAwNiwgMTUuMTIyOV0sIFs3NS42OTQ4LCAxNS45OTI4XV1dXSwgXCJ0eXBlXCI6IFwiTXVsdGlQb2x5Z29uXCJ9fV19IgoJCQkJCQkJfSwKCQkJCQkJCXsKCQkJCQkJCQkiY29kZSI6ICJkYXlfZnJvbSIsCgkJCQkJCQkJInZhbHVlIjogIjEiCgkJCQkJCQl9LAoJCQkJCQkJewoJCQkJCQkJCSJjb2RlIjogImRheV90byIsCgkJCQkJCQkJInZhbHVlIjogIjciCgkJCQkJCQl9LAoJCQkJCQkJewoJCQkJCQkJCSJjb2RlIjogInRpbWVfZnJvbSIsCgkJCQkJCQkJInZhbHVlIjogIjAwMDAiCgkJCQkJCQl9LAoJCQkJCQkJewoJCQkJCQkJCSJjb2RlIjogInRpbWVfdG8iLAoJCQkJCQkJCSJ2YWx1ZSI6ICIyMzU5IgoJCQkJCQkJfQoJCQkJCQldCgkJCQkJfQoJCQkJXQoJCQl9CgkJXQoJfQp9CmZ1bmN0aW9uIGdlbmVyYXRlSW5pdFBheW1lbnRzKHRvdGFsQW1vdW50LCB1c2VyX2lucHV0cykgewoJY29uc29sZS5sb2coInVzZXJfaW5wdXRzIiwgSlNPTi5zdHJpbmdpZnkodXNlcl9pbnB1dHMpKTsKCWlmICghdXNlcl9pbnB1dHMud2FudF9wYXJ0X3BheW1lbnQpIHsKCQlyZXR1cm4gWwoJCQl7CgkJCQlpZDogIjEiLAoJCQkJdHlwZTogIk9OLU9SREVSIiwKCQkJCXN0YXR1czogIk5PVC1QQUlEIiwKCQkJCWNvbGxlY3RlZF9ieTogIkJBUCIsCgkJCQlwYXJhbXM6IHsKCQkJCQlhbW91bnQ6IHRvdGFsQW1vdW50LAoJCQkJCWN1cnJlbmN5OiAiSU5SIgoJCQkJfQoJCQl9CgkJXTsKCX0KCWNvbnN0IGFkdmFuY2VBbW91bnQgPQoJCXVzZXJfaW5wdXRzLmFkdmFuY2VfYW1vdW50IHx8CgkJKHBhcnNlRmxvYXQodG90YWxBbW91bnQpICogMC4yKS50b0ZpeGVkKDIpOwoKCWNvbnN0IHJlbWFpbmluZ0Ftb3VudCA9ICgKCQlwYXJzZUZsb2F0KHRvdGFsQW1vdW50KSAtIHBhcnNlRmxvYXQoYWR2YW5jZUFtb3VudCkKCSkudG9GaXhlZCgyKTsKCglyZXR1cm4gWwoJCXsKCQkJaWQ6ICIzIiwKCQkJdHlwZTogIlBBUlQtUEFZTUVOVCIsCgkJCXRhZ3M6IFsKCQkJCXsKCQkJCQlkZXNjcmlwdG9yOiB7IGNvZGU6ICJMSU5LRUQtUEFZTUVOVFMiIH0sCgkJCQkJbGlzdDogWwoJCQkJCQl7IGRlc2NyaXB0b3I6IHsgY29kZTogInB5bW50LXBhcnQtMSIgfSwgdmFsdWU6ICIxIiB9LAoJCQkJCQl7IGRlc2NyaXB0b3I6IHsgY29kZTogInB5bW50LXBhcnQtMiIgfSwgdmFsdWU6ICIyIiB9CgkJCQkJXQoJCQkJfQoJCQldCgkJfSwKCQl7CgkJCWlkOiAicHltbnQtcGFydC0xIiwKCQkJdHlwZTogIk9OLU9SREVSIiwKCQkJc3RhdHVzOiAiTk9ULVBBSUQiLAoJCQljb2xsZWN0ZWRfYnk6ICJCQVAiLAoJCQl0YWdzOiBbCgkJCQl7IGRlc2NyaXB0b3I6IHsgY29kZTogIkFEVi1ERVBPU0lUIiB9IH0KCQkJXSwKCQkJcGFyYW1zOiB7CgkJCQlhbW91bnQ6IGFkdmFuY2VBbW91bnQsCgkJCQljdXJyZW5jeTogIklOUiIKCQkJfQoJCX0sCgkJewoJCQlpZDogInB5bW50LXBhcnQtMiIsCgkJCXR5cGU6ICJPTi1GVUxGSUxMTUVOVCIsCgkJCXN0YXR1czogIk5PVC1QQUlEIiwKCQkJY29sbGVjdGVkX2J5OiAiQlBQIiwKCQkJdGFnczogWwoJCQkJeyBkZXNjcmlwdG9yOiB7IGNvZGU6ICJGSU5BTC1QQVlNRU5UIiB9IH0KCQkJXSwKCQkJcGFyYW1zOiB7CgkJCQlhbW91bnQ6IHJlbWFpbmluZ0Ftb3VudCwKCQkJCWN1cnJlbmN5OiAiSU5SIgoJCQl9CgkJfQoJXTsKfQpmdW5jdGlvbiB1cGRhdGVDb25maXJtUGF5bWVudHNGcm9tSW5pdChpbml0UGF5bWVudHMpIHsKCWlmICghQXJyYXkuaXNBcnJheShpbml0UGF5bWVudHMpKSByZXR1cm4gW107CgoJcmV0dXJuIGluaXRQYXltZW50cy5tYXAoKHBheW1lbnQpID0+IHsKCQlpZiAocGF5bWVudC50eXBlID09PSAiUEFSVC1QQVlNRU5UIikgewoJCQlyZXR1cm4gcGF5bWVudDsKCQl9CgkJaWYgKHBheW1lbnQudHlwZSA9PT0gIk9OLU9SREVSIikgewoJCQlyZXR1cm4gewoJCQkJLi4ucGF5bWVudCwKCQkJCXN0YXR1czogIlBBSUQiLAoJCQkJY29sbGVjdGVkX2J5OiBwYXltZW50LmNvbGxlY3RlZF9ieSB8fCAiQkFQIiwKCQkJCXBhcmFtczogewoJCQkJCS4uLnBheW1lbnQucGFyYW1zLAoJCQkJCXRyYW5zYWN0aW9uX2lkOiBgVVRSLSR7RGF0ZS5ub3coKX1gCgkJCQl9CgkJCX07CgkJfQoKCQlpZiAocGF5bWVudC50eXBlID09PSAiT04tRlVMRklMTE1FTlQiKSB7CgkJCXJldHVybiB7CgkJCQkuLi5wYXltZW50LAoJCQkJc3RhdHVzOiBwYXltZW50LnN0YXR1cyB8fCAiTk9ULVBBSUQiCgkJCX07CgkJfQoKCQlyZXR1cm4gcGF5bWVudDsKCX0pOwp9CmZ1bmN0aW9uIGFkanVzdFF1b3RlRm9yRnVsZmlsbG1lbnQocXVvdGUsIGZ1bGZpbGxtZW50VHlwZSwgZnVsZmlsbG1lbnRJZCkgewogIGlmICghcXVvdGUpIHJldHVybiBxdW90ZTsKCiAgY29uc3QgYnJlYWt1cCA9IFtdOwogIGxldCB0b3RhbCA9IDA7CgogIGZvciAoY29uc3QgaXRlbSBvZiBxdW90ZS5icmVha3VwKSB7CiAgICBjb25zdCBjbG9uZWQgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGl0ZW0pKTsKCiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gREVMSVZFUlkgVFlQRSBMT0dJQwogICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIGlmIChmdWxmaWxsbWVudFR5cGUgPT09ICJTZWxmLVBpY2t1cCIpIHsKICAgICAgLy8gUmVtb3ZlIGRlbGl2ZXJ5IGNoYXJnZXMKICAgICAgaWYgKGNsb25lZFsiQG9uZGMvb3JnL3RpdGxlX3R5cGUiXSA9PT0gImRlbGl2ZXJ5IikgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICB9CgogICAgaWYgKGZ1bGZpbGxtZW50VHlwZSA9PT0gIkRlbGl2ZXJ5IikgewogICAgICAvLyBFbnN1cmUgZGVsaXZlcnkgZXhpc3RzCiAgICAgIGlmIChjbG9uZWRbIkBvbmRjL29yZy90aXRsZV90eXBlIl0gPT09ICJkZWxpdmVyeSIpIHsKICAgICAgICBjbG9uZWRbIkBvbmRjL29yZy9pdGVtX2lkIl0gPSBmdWxmaWxsbWVudElkOwogICAgICB9CiAgICB9CgogICAgdG90YWwgKz0gcGFyc2VGbG9hdChjbG9uZWQucHJpY2UudmFsdWUgfHwgMCk7CiAgICBicmVha3VwLnB1c2goY2xvbmVkKTsKICB9CgogIHJldHVybiB7CiAgICAuLi5xdW90ZSwKICAgIGJyZWFrdXAsCiAgICBwcmljZTogewogICAgICBjdXJyZW5jeTogIklOUiIsCiAgICAgIHZhbHVlOiB0b3RhbC50b0ZpeGVkKDIpCiAgICB9CiAgfTsKfQpmdW5jdGlvbiBub3JtYWxpemVQYXltZW50cyhvcmRlciwgYWN0aW9uKSB7CiAgY29uc3QgcGF5bWVudHMgPSBvcmRlci5wYXltZW50cyB8fCBbXTsKICBjb25zdCB0b3RhbEFtb3VudCA9IHBhcnNlRmxvYXQob3JkZXIucXVvdGU/LnByaWNlPy52YWx1ZSB8fCAiMCIpOwoKICByZXR1cm4gcGF5bWVudHMubWFwKChwYXltZW50KSA9PiB7CiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gUEFSVC1QQVlNRU5UIFJPT1Qg4oaSIGFsd2F5cyB1bmNoYW5nZWQKICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICBpZiAocGF5bWVudC50eXBlID09PSAiUEFSVC1QQVlNRU5UIikgewogICAgICByZXR1cm4gcGF5bWVudDsKICAgIH0KCiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gT04tT1JERVIKICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICBpZiAocGF5bWVudC50eXBlID09PSAiT04tT1JERVIiKSB7CiAgICAgIGlmIChhY3Rpb24gPT09ICJvbl9jb25maXJtIikgewogICAgICAgIC8vIElmIGFscmVhZHkgUEFJRCwgbXVzdCBjb250YWluIHRyYW5zYWN0aW9uX2lkCiAgICAgICAgaWYgKHBheW1lbnQuc3RhdHVzID09PSAiUEFJRCIpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIC4uLnBheW1lbnQsCiAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgIC4uLnBheW1lbnQucGFyYW1zLAogICAgICAgICAgICAgIHRyYW5zYWN0aW9uX2lkOgogICAgICAgICAgICAgICAgcGF5bWVudC5wYXJhbXM/LnRyYW5zYWN0aW9uX2lkIHx8CiAgICAgICAgICAgICAgICBgVVRSLSR7RGF0ZS5ub3coKX1gCiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gcGF5bWVudDsKICAgIH0KCiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gT04tRlVMRklMTE1FTlQKICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICBpZiAocGF5bWVudC50eXBlID09PSAiT04tRlVMRklMTE1FTlQiKSB7CiAgICAgIGNvbnN0IGFkdmFuY2UgPSBwYXltZW50cy5maW5kKAogICAgICAgIChwKSA9PiBwLnR5cGUgPT09ICJPTi1PUkRFUiIKICAgICAgKTsKCiAgICAgIGNvbnN0IGFkdmFuY2VBbW91bnQgPSBwYXJzZUZsb2F0KAogICAgICAgIGFkdmFuY2U/LnBhcmFtcz8uYW1vdW50IHx8ICIwIgogICAgICApOwoKICAgICAgY29uc3QgcmVtYWluaW5nQW1vdW50ID0gKAogICAgICAgIHRvdGFsQW1vdW50IC0gYWR2YW5jZUFtb3VudAogICAgICApLnRvRml4ZWQoMik7CgogICAgICAvLyBPbmx5IGVuZm9yY2UgcGFyYW1zIGluIG9uX2NvbmZpcm0KICAgICAgaWYgKGFjdGlvbiA9PT0gIm9uX2NvbmZpcm0iKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIC4uLnBheW1lbnQsCiAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgYW1vdW50OiByZW1haW5pbmdBbW91bnQsCiAgICAgICAgICAgIGN1cnJlbmN5OiAiSU5SIgogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHJldHVybiBwYXltZW50OwogICAgfQoKICAgIHJldHVybiBwYXltZW50OwogIH0pOwp9CmZ1bmN0aW9uIGJ1aWxkT25Db25maXJtRnVsZmlsbG1lbnQoY29uZmlybU9yZGVyLCBmdWxmaWxsbWVudElucHV0KSB7CiAgY29uc3QgZnVsZmlsbG1lbnRUeXBlID0gZnVsZmlsbG1lbnRJbnB1dC50eXBlOwogIGNvbnN0IGZ1bGZpbGxtZW50SWQgPSBmdWxmaWxsbWVudElucHV0LmlkOwoKICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpOwogIGNvbnN0IHN0YXJ0VGltZSA9IG5ldyBEYXRlKG5vdy5nZXRUaW1lKCkgKyA2MCAqIDYwICogMTAwMCk7CiAgY29uc3QgZW5kVGltZSA9IG5ldyBEYXRlKHN0YXJ0VGltZS5nZXRUaW1lKCkgKyAzMCAqIDYwICogMTAwMCk7CgogIHJldHVybiB7CiAgICBpZDogZnVsZmlsbG1lbnRJZCwKICAgIHR5cGU6IGZ1bGZpbGxtZW50VHlwZSwKCiAgICAiQG9uZGMvb3JnL1RBVCI6CiAgICAgIGZ1bGZpbGxtZW50VHlwZSA9PT0gIlNlbGYtUGlja3VwIiA/ICJQVDJIIiA6ICJQVDRIIiwKCiAgICAiQG9uZGMvb3JnL3Byb3ZpZGVyX25hbWUiOgogICAgICBmdWxmaWxsbWVudFR5cGUgPT09ICJEZWxpdmVyeSIKICAgICAgICA/ICJMU1AgRXhwcmVzcyIKICAgICAgICA6IGNvbmZpcm1PcmRlci5wcm92aWRlcj8uZGVzY3JpcHRvcj8ubmFtZSB8fCAiQUJDIFN0b3JlIiwKCiAgICBzdGF0ZTogewogICAgICBkZXNjcmlwdG9yOiB7IGNvZGU6ICJQZW5kaW5nIiB9CiAgICB9LAoKICAgIHRyYWNraW5nOiBmdWxmaWxsbWVudFR5cGUgPT09ICJEZWxpdmVyeSIsCiAgICBzdGFydDogewogICAgICBsb2NhdGlvbjogewogICAgICAgIGRlc2NyaXB0b3I6IHsKICAgICAgICAgIG5hbWU6ICJBQkMgU3RvcmUiCiAgICAgICAgfSwKICAgICAgICBncHM6ICIxMi45Njc1LDc3Ljc0OTYiLAogICAgICAgIGFkZHJlc3M6IHsKICAgICAgICAgIGxvY2FsaXR5OiAiSmF5YW5hZ2FyIiwKICAgICAgICAgIGNpdHk6ICJCZW5nYWx1cnUiLAogICAgICAgICAgYXJlYV9jb2RlOiAiNTYwMDc2IiwKICAgICAgICAgIHN0YXRlOiAiS0EiCiAgICAgICAgfQogICAgICB9LAogICAgICBjb250YWN0OiB7CiAgICAgICAgcGhvbmU6ICI5ODg2MDk4ODYwIiwKICAgICAgICBlbWFpbDogIm5vYm9keUBub21haWwuY29tIgogICAgICB9CiAgICB9LAogICAgZW5kOiB7CiAgICAgIGxvY2F0aW9uOiBjb25maXJtT3JkZXIuZnVsZmlsbG1lbnRzWzBdLmVuZC5sb2NhdGlvbiwKICAgICAgdGltZTogewogICAgICAgIHJhbmdlOiB7CiAgICAgICAgICBzdGFydDogc3RhcnRUaW1lLnRvSVNPU3RyaW5nKCksCiAgICAgICAgICBlbmQ6IGVuZFRpbWUudG9JU09TdHJpbmcoKQogICAgICAgIH0KICAgICAgfSwKICAgICAgcGVyc29uOiBjb25maXJtT3JkZXIuZnVsZmlsbG1lbnRzWzBdLmVuZC5wZXJzb24sCiAgICAgIGNvbnRhY3Q6IGNvbmZpcm1PcmRlci5mdWxmaWxsbWVudHNbMF0uZW5kLmNvbnRhY3QKICAgIH0sCiAgICB0YWdzOiBbCiAgICAgIHsKICAgICAgICBjb2RlOiAicm91dGluZyIsCiAgICAgICAgbGlzdDogWwogICAgICAgICAgewogICAgICAgICAgICBjb2RlOiAidHlwZSIsCiAgICAgICAgICAgIHZhbHVlOiBmdWxmaWxsbWVudFR5cGUgPT09ICJEZWxpdmVyeSIgPyAiUDJQIiA6ICJTdG9yZS1QaWNrdXAiCiAgICAgICAgICB9CiAgICAgICAgXQogICAgICB9LAogICAgICB7CiAgICAgICAgY29kZTogInRyYWNraW5nIiwKICAgICAgICBsaXN0OiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvZGU6ICJncHNfZW5hYmxlZCIsCiAgICAgICAgICAgIHZhbHVlOiBmdWxmaWxsbWVudFR5cGUgPT09ICJEZWxpdmVyeSIgPyAieWVzIiA6ICJubyIKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvZGU6ICJ1cmxfZW5hYmxlZCIsCiAgICAgICAgICAgIHZhbHVlOiAibm8iCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBjb2RlOiAidXJsIiwKICAgICAgICAgICAgdmFsdWU6ICJodHRwczovL3NucC5jb20vb25kYy90cmFja2luZ191cmwiCiAgICAgICAgICB9CiAgICAgICAgXQogICAgICB9CiAgICBdCiAgfTsKfQ==
